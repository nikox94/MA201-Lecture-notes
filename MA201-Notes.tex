\documentclass[11pt]{article}
\usepackage[a4paper,includeheadfoot,margin=2.54cm]{geometry}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[unicode=true]{hyperref}
\usepackage{breakurl}
\usepackage{indentfirst}
\usepackage{pgf, tikz}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{esvect}
\usepackage{breqn}

\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}
  \theoremstyle{plain}
  \newtheorem{thm}{\protect\theoremname}[section]
  \theoremstyle{definition}
  \newtheorem{defn}[thm]{\protect\definitionname}
  \theoremstyle{remark}
  \newtheorem*{notation*}{\protect\notationname}
  \theoremstyle{definition}
  \newtheorem*{example*}{\protect\examplename}
  \theoremstyle{remark}
  \newtheorem*{note*}{\protect\notename}
  \theoremstyle{plain}
  \newtheorem{lem}[thm]{\protect\lemmaname}
  \theoremstyle{definition}
  \newtheorem*{defn*}{\protect\definitionname}
  \theoremstyle{definition}
  \newtheorem{example}[thm]{\protect\examplename}
  \theoremstyle{plain}
  \newtheorem{cor}[thm]{\protect\corollaryname}
  \theoremstyle{plain}
  \newtheorem{prop}[thm]{\protect\propositionname}
  \theoremstyle{plain}
  \newtheorem*{prop*}{\protect\propositionname}
  \theoremstyle{definition}
  \newtheorem{xca}[thm]{\protect\exercisename}
  \newcommand\thmsname{\protect\theoremname}
%  \newcommand\nm@thmtype{theorem}
  \theoremstyle{plain}
  \newtheorem*{namedtheorem}{\thmsname}
  \newenvironment{namedthm}[1][Undefined Theorem Name]{
   \ifx{#1}{Undefined Theorem Name}\renewcommand\nm@thmtype{theorem*}
   \else\renewcommand\thmsname{#1}\renewcommand\nm@thmtype{namedtheorem}
   \fi
   \begin{\nm@thmtype}}
   {\end{\nm@thmtype}}

  \providecommand{\corollaryname}{Следствие}
  \providecommand{\definitionname}{Дефиниция}
  \providecommand{\examplename}{Пример}
  \providecommand{\exercisename}{Упражнение}
  \providecommand{\lemmaname}{Лема}
  \providecommand{\notationname}{Нотация}
  \providecommand{\notename}{Забележка}
  \providecommand{\propositionname}{Твърдение}
  \providecommand{\remarkname}{Забележка}
  \providecommand{\theoremname}{Теорема}

\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\renewcommand*{\Vec}[1]{\mathbf{#1}}
\newcommand*{\Z}{\Vec{0}}
\newcommand*{\B}{\mathcal{B}}
\newcommand*{\R}{\mathbb{R}}
\newcommand*{\N}{\mathbb{N}}
\newcommand*{\Q}{\mathbb{Q}}
\newcommand*{\p}{\partial}

\title{Лекционни записки по Математически Анализ}
\author{проф. Надежда Рибарска \\ Набрани от Никола Юруков}
\date{\today}


\begin{document}

\maketitle

\clearpage

\tableofcontents

\clearpage

\section{Лекция 1: Преговор с разширение}

\subsection{Евклидовото пространство $\mathbb{R}^n$}

Като множество $\mathbb{R}^n$ е множеството $\{x = (x_1, x_2, ..., x_n): x_i \in \mathbb{R}, \  i=1,2,..,n\}$ от нередените $n$-торки реални числа. Ако го снабдим със стандартните линейни операции събиране на вектори и умножение на вектор с реално число, получаваме реално линейно пространство (спомнете си аксиомите от курса по линейна алгебра). Да напомним формалните дефиниции: сума на векторите $x = (x_1, x_2, ..., x_n)$ и $y = (y_1, y_2, ..., y_n)$ е векторът $x+y = (x_1+y_1, x_2+y_2, ..., x_n + y_n)$ (събирането е покоординатно). Произведение на скалара $\lambda \in \mathbb{R}$ с вектора $x$ е векторът $\lambda x = (\lambda x_1, \lambda x_2, ..., \lambda x_n)$ (умножението със скалар също е покоординатно). Ще означаваме с $\Z$ нулевия вектор $(0,\dots ,0)$.

За да можем да правим анализ (да говорим за граница, непрекъснатост, производна и т.н.), освен линейната структура ни е необходима и някаква "мярка на близост" в нашето пространство. Както помните от курса по ДИС2, стандартната мярка на близост  между два вектора е евклидовото разстояние между тях:
 $$\rho(x,y):= \sqrt{\sum_{i=1}^n (x_i-y_i)^2} \ , \mbox{ където } x = (x_1, x_2, ..., x_n), \ y = (y_1, y_2, ..., y_n) \ .$$
 Забележете, че в $\mathbb{R}^2$ това е просто питагоровата теорема. Това разстояние е добре съгласувано с линейната структура в смисъл, че $\rho(x,y)=\lVert x - y\rVert$, където в дясната част стои евклидовата норма (или дължината) на вектора $x-y$:
 $$\lVert x\rVert := \sqrt{\sum_{i=1}^n x_i^2}\ , \ x = (x_1, x_2, ..., x_n) \ .$$

 Да напомним, че една функция $\lVert \cdot \rVert :\mathbb{R}^n \longrightarrow [0,+\infty)$ се нарича норма, ако за нея са в сила свойствата
\begin{enumerate}
	\item $\lVert x \rVert = 0 \iff x=\Z$
	\item $\norm{\lambda x} = |\lambda|\cdot \norm{x}$
	\item $\norm{x+y} \leq \norm{x} + \norm{y}$ (неравенство на триъгълника)
\end{enumerate}

В курса по ДИС2 е проверено, че евклидовата норма е норма. За упражнение проверете, че
\begin{itemize}
 \item $\norm{(x_1, x_2)}_1 = |x_1| + |x_2|$
 \item $\norm{(x_1, x_2)}_\infty = $ max\{$|x_1|, |x_2|$\}
 \item $\norm{(x_1, x_2)}_p = \sqrt[p]{|x_1|^p + |x_2|^p}$, $1< p<\infty$
\end{itemize}
са норми в $\mathbb{R}^2$.
По-общо, проверете, че  $$\norm{x}_p = \sqrt[p]{\sum_{i=1}^n |x_i|^p} \ , \ 1\leq p<\infty \mbox{ е норма в } \mathbb{R}^n \ .$$
Разбира се, за целта трябва да използвате неравенството на Минковски от курса по ДИС2.

Евклидовата норма има по-хубави геометрични свойства от горните примери, защото е съгласувана със скаларното произведение
$$\langle x, y\rangle = \sum_{i=1}^n x_i y_i  \ , \mbox{ където } x = (x_1, x_2, ..., x_n) \mbox{ и } \ y = (y_1, y_2, ..., y_n),$$
по стандартния начин $\lVert x \rVert =\sqrt{\langle x, x\rangle}$. Да напомним основното неравенство на Коши-Буняковски-Шварц:
$$|\langle x, y\rangle | \leq \norm{x}\norm{y} \ .$$

Да напомним също означенията
$$B_r(x) := \left\{ y\in \mathbb{R}^n : \norm{y-x}<r\right\}$$
за отворено кълбо с център $x$ и радиус $r$ и
$$\overline{B}_r(x) := \left\{ y\in \mathbb{R}^n : \norm{y-x}\leq r\right\}$$
за затворено кълбо с център $x$ и радиус $r$. Като упражнение можете да скицирате кълбата с радиус 1 и център началото на координатната система за нормите $\norm{\cdot}_1$ и $\norm{\cdot}_\infty$ от предишното упражнение.

%TODO add graphics for intervals and p-norms.

\subsection{Топология в $\mathbb{R}^n$}

\begin{defn}
Подмножеството $U$ на $\R^n$ се нарича отворено, ако за всяка точка $x$ от $U$ съществува $\varepsilon>0$ такова, че $B_\varepsilon (x) \subset U$.
\end{defn}

Основните свойства на отворените множества, проверени в курса по ДИС2, са

1. $\emptyset$ и $\R^n$ са отворени

2. Сечение на краен брой отворени множества е отворено, т.е. ако $U_1, U_2, ..., U_k$ са отворени, то $\bigcap_{i=1}^k U_i$ е отворено.

3. Обединение на произволна фамилия от отворени множества е отворено, т.е. ако $U_\alpha$ са отворени за всяко $\alpha \in I$, то $\bigcup _{\alpha \in I} U_\alpha$ е отворено.

\begin{example}
Отворените кълба са отворени множества.
\begin{proof}
Да разгледаме $B_r(x_0)$, $r>0$. Взимаме си произволно $x$ от кълбото, т.е. растоянието между $x$ и $x_0$ е по-малко от $r$. Нека $\varepsilon := r - \norm{x_0-x}>0$. Тогава $B_\varepsilon(x)\subset B_r(x_0)$. Наистина, нека $y\in B_\varepsilon(x)$, т.е. $\norm{y-x} <\varepsilon$. Получаваме
\begin{eqnarray*}
\norm{x_0-y} &\leq& \norm{x-y} + \norm{x-x_0} < \varepsilon + \norm{x-x_0}\\
\norm{x_0-y} &<& r - \norm{x_0-x} + \norm{x-x_0}\\
\norm{x_0-y} &<& r
\end{eqnarray*}
\end{proof}
\end{example}

\begin{example}
Нека функцията  $g:\R^n \rightarrow \R$ е \textbf{непрекъсната}. Тогава множеството \\ $U = \{x\in\R^n:g(x)>0\}$ е отворено.
\begin{proof}
Взимаме произволна точка $x_0\in U$, следователно $\varepsilon = g(x_0)>0$. От непрекъснатостта на функцията получаваме, че съществува положително число $\delta$ такова, че $|g(x)-g(x_0)|<\varepsilon$ за всяко $x\in B_\delta(x_0)$. Следователно $g(x)>g(x_0)-\varepsilon = 0$ и оттук $x \in U$ за всяко $x\in B_\delta(x_0)$.
\end{proof}
\end{example}

\begin{defn} Едно подмножество
$F$ на $\R^n $ се нарича затворено, ако $\R^n \setminus F$ е отворено множество.
\end{defn}

Основните свойства на затворените множества, проверени в курса по ДИС2, са

1. $\emptyset, \R^n$ са затворени.

2. Обединие на краен брой затворени множества е затворено, т.е. ако $F_1, F_2, ..., F_k$ са затворени, то $\bigcup_{i=1}^k F_i$ е затворено.

3. Сечение на произволна фамилия от затворени множества е затворено, т.е. ако $F_\alpha$ са затворени за всички $\alpha \in I$, то $\bigcap _{\alpha \in I} F_\alpha$ е затворено.

\begin{example}
Затворените кълба са затворени множества. Доказателството оставяме за упражнение.
\end{example}

\begin{defn}
Контур на множеството $A \subset \R^n$ наричаме множеството
$$\partial A := \{ x\in \R^n : \forall U \; \text{отворено}, \; x\in U \mbox{ е в сила } U \cap A \neq \emptyset \mbox{ и } U\setminus A \neq \emptyset \}$$
\end{defn}

\begin{defn}
Затворена обвивка на множеството $A \subset \R^n$ наричаме най-малкото затворено множество, съдържащо $A$:
$$\overline{A} := \cap \left\{ F \subset \R^n : \ F \supset A  \mbox{ и } F  \mbox{ е затворено }\right\}$$
\end{defn}

В курса по ДИС2 е доказано, че
$$\overline{A} = \{x\in\R^n: \exists \{x_m\}_{m=1}^\infty \subset A,\; x_m \rightarrow x \}$$
Лесно се проверява, че едно множество е затворено точно тогава, когато съвпада със затворената си обвивка. Връзките между контур на множество и затворена обвивка на множество са
$$\overline{A}= A \cup \partial A \ , \ \partial A =\overline{A} \cap \left(\overline{\R^n\setminus A}\right) \ .$$
Следователно контурът на произволно множество е винаги затворено множество. Също лесно се проверява, че
$$\partial A = \{x \in \R^n : \ \exists \{x_m\}_{m=1}^\infty \subset A, \ x_m \rightarrow x  \mbox{ и } \exists \{y_m\}_{m=1}^\infty \subset \R^n\setminus A, \  y_m \rightarrow x\}$$

\begin{defn}
Вътрешност на $A\subset\R^n$ наричаме най-голямото отворено множество, съдържащо се в $A$:
$$\mathring{A} = \cup \left\{ U \subset \R^n : \ U \subset A  \mbox{ и } U  \mbox{ е отворено }\right\}$$
\end{defn}

Друго означение за вътрешност на $A$ е $int A$. Понятието за вътрешност е дуално на понятието за затворена обвивка, т.е.
$$int{A} = \R^n \setminus \left(\overline{\R^n\setminus A}\right) \ , \ \overline{A}=
\R^n \setminus \left(int{(\R^n\setminus A)}\right) \ .$$

Едно от най-важните и често използвани понятия в топологията е понятието за компактност.
\begin{defn}
Едно множество $A\subset \R^n$ се нарича компакт, ако от всяко негово отворено покритие можем да изберем крайно подпокритие, т.е. ако $\{U_\alpha\}_{\alpha \in I}$ е фамилия от отворени подмножества на $\R^n$, за която е в сила $\cup_{\alpha\in I} U_\alpha \supset A$, то можем да изберем краен брой индекси $\alpha_1, \alpha_2, \dots , \alpha_k \in I$ такива, че $\cup_{i=1}^k U_{\alpha_i} \supset A$.
\end{defn}

В курса по ДИС2 са доказани две важни и нетривиални характеризации на компактните подмножества на $\R^n$:

1. Едно подмножество $A$ на $\R^n$ е компакт точно тогава, когато $A$ е ограничено и затворено.

2. Едно подмножество $A$ на $\R^n$ е компакт точно тогава, когато от всяка редица от негови елементи може да се избере сходяща подредица, чиято граница е също в множеството.

\bigskip

Сега въвеждаме първото разширение, т.е. понятие, за което не сте учили в курса по ДИС2: множество, релативно отворено в $A$. Ще го използваме по-нататък, за да говорим за множества, релативно отворени в някаква гладка двумерна повърхнина в тримерното евклидово пространство. Интуицията е, че забравяме за всичко извън множеството $A$.

\begin{defn} Нека $A \subset \R^n$. Едно подмножество $U$ на $A$ наричаме релативно отворено в $A$, ако съществува отворено множество $V\subset \R^n$ такова, че $U = A\cap V$.
\end{defn}
\begin{prop}
Множеството $U\subset A$ е релативно отворено в $A$ точно тогава, когато за всяка негова точка $x\in U$ съществува $\varepsilon >0$ такова, че $B_\varepsilon (x)\cap A \subset U$.
\end{prop}
\begin{proof}
Нека първо $U\subset A$ е релативно отворено в $A$ и $x\in U$ е произволна. Тогава съществува отворено множество $V\subset \R^n$ с $U = A\cap V$. Тъй като $x\in U\subset V$, съществува $\varepsilon >0$ с $B_\varepsilon (x) \subset V$ и оттук $B_\varepsilon (x)\cap A \subset V\cap A=U$. В обратната посока, нека за всяка точка $x\in U$ съществува $\varepsilon_x >0$ такова, че $B_{\varepsilon_x} (x)\cap A \subset U$. Полагаме
$V:= \cup_{ x\in U} B_{\varepsilon_x} (x)$. Очевидно $V$ е отворено множество като обединение на отворени кълбета. Освен това
$$V\cap A=\left(\cup_{ x\in U} B_{\varepsilon_x} (x)\right)\cap A=\cup_{ x\in U}\left( B_{\varepsilon_x} (x)\cap A\right)\subset U \ .$$
От друга страна, всяка точка $x\in U$ принадлежи на $B_{\varepsilon_x} (x) \subset V$, следователно $U\subset V$ и от $U\subset A$ следва $U\subset V\cap A$. С това $U= V\cap A$ и доказателството е завършено.
\end{proof}

Следното приложение на понятието за релативна отвореност е важно и изключително често използвано:
\begin{prop}
Нека $f: D \longrightarrow \R^m$ е изображение с дефиниционна област $D\subset \R^n$ и стойности в $\R^m$. Твърдим, че $f$ е непрекъсната в $D$ точно тогава когато първообраз на всяко отворено в $\R^m$ множество е релативно отворено в $D$. Да напомним, че първообраз на $U\subset \R^m$ е множеството
$f^{-1} (U) := \{x\in D: f(x) \in U\}$.
\end{prop}
\begin{proof}
Първо ще докажем, че ако първообраз на всяко отворено в $\R^m$ множество е релативно отворено в $D$, то $f$ е непрекъсната.
Избираме произволна точка $x$ от $D$ и произволно $\varepsilon >0$. Тъй като кълбото $B_{\varepsilon}(f(x))$ е отворено в $\R^m$, първообразът $f^{-1} (B_{\varepsilon}(f(x)))$ ще е релативно отворен в $D$. Тогава $f^{-1} (B_{\varepsilon}(f(x)))= D \cap V$ за някое множество $V$, отворено в $\R^n$. Тъй като $x\in f^{-1} (B_{\varepsilon}(f(x)))\subset  V$, съществува $\delta >0$ с $B_\delta (x) \subset V$. Нека $x'\in D$ е произволна точка с $\| x' -x\| <\delta$. Значи $x' \in D \cap B_\delta(x) \subset D\cap V=f^{-1} (B_{\varepsilon}(f(x)))$ и следователно $f(x')\in B_{\varepsilon}(f(x))$, т.е. $\| f(x')-f(x)\| <\varepsilon$.

За да докажем обратната посока, избираме произволно отворено $U\subset \R^m$.
Нека $x\in f^{-1} (U)$. Тогава $f(x)$ принадлежи на отвореното множество $U$ и следователно съществува $\varepsilon >0$ такова, че $B_\varepsilon(f(x)) \subset U$. Тъй като $f$ е непрекъсната в $x$, съществува $\delta >0$ такова, че $\| f(x')-f(x)\| <\varepsilon$ за всяко $x'\in D$, за което $\| x'-x\| <\delta$. Записано по друг начин това означава, че $f(B_{\delta}(x)\cap D) \subset B_\varepsilon (f(x)) \subset U$, следователно $B_{\delta}(x)\cap D \subset f^{-1} (U)$. Така доказахме, че множеството $f^{-1} (U)$ е релативно отворено в $D$, защото изпълнява условието от предишното твърдение.
\end{proof}

\subsection{Основни теореми}

\begin{thm}[Теорема на Вайерщрас]
Непрекъснат образ на компакт е компакт. Формално записано, ако
$f: K  \longrightarrow \R^m$ е непрекъснато изображение с дефиниционна област компактното подмножество $K$ на $\R^n$, то множеството  $f(K) := \{f(x):x\in K\}$ от стойностите на $f$ е компактно подмножество на $\R^m$.
\end{thm}
\begin{proof}
Нека $\{y_l\}_{l=1}^\infty \subset f(K)$ е редица от елементи на $f(K)$. Тогава за всеки елемент $y_l$ на тази редица съществува елемент  $x_l$ на $K$ такъв, че $y_l = f(x_l)$. Сега редицата $\{x_l\}_{l=1}^\infty$ се съдържа в компактното множество $K$. Следователно съществува нейна сходяща подредица $\{ x_{l_k}\}_{k=1}^\infty$, чиято граница $x_0$ е елемент на $K$. Тъй като $f$ е непрекъсната, от дефиницията на Хайне за непрекъснатост получаваме, че $f(x_{l_k}) = y_{l_k} \xrightarrow[k \rightarrow \infty]{} f(x_0)$. Тъй като очевидно $f(x_0)\in f(K)$, остава да се позовем на характеризацията (2) на компактните множества.
\end{proof}

Хубаво упражнение е да се докаже теоремата на Вайерщрас, като се използва дефиницията на компакт и характеризацията на непрекъснатите изображения, която доказахме.

Друго добро упражнение е да се убедите, че теоремата на Вайерщрас от ДИС 1 (една непрекъсната функция върху краен затворен интервал е ограничена и достига своята най-голяма и най-малка стойност) е следствие от тази форма на теоремата.

\bigskip

\begin{thm}[Теорема на Кантор]\label{genCantor}
Нека $f:D\longrightarrow \R^m$ е дефинирана в $D \subset \R^n$. Нека $K$ е компактно подмножество на $D$.
Ако $f$ е непрекъсната в $K$, т.е. непрекъсната е във всяка точка от $K$, то твърдим, че за всяко
$\varepsilon >0$ съществува $\delta >0$ такова, че за всяко $x \in K$ и за всички $x' \in D$, за които е изпълнено $\norm{x'-x}<\delta$, е в сила
$\|f(x)-f(x')\|<\varepsilon$. Забележете, че заключението е малко по-силно от равномерна непрекъснатост на $f$ върху $K$.
\end{thm}
\begin{proof}
Отново ще използваме характеризацията (2) на компактността чрез редици. Допускаме противното, т.е. съществува такова $\varepsilon_0 >0$, че за всички $\delta >0$ съществуват точки $x_\delta \in K$ и $x'_\delta \in D$ такива, че
$$\norm{x_\delta - x'_\delta}<\delta \mbox{ и } \|f(x_\delta)-f(x'_\delta)\|\geq \varepsilon \ .$$
Даваме на $\delta$ стойности  $1, \frac{1}{2}, \frac{1}{3}, \dots$ и преименуваме $x_{1/m}$ и $x_{1/m}'$ съответно на $x_m$ и $x'_m$. Така се образуват две редици $\{x_m\}_{m=1}^\infty \subset K$ и $\{x'_m\}_{m=1}^\infty \subset D$.
Знаем, че
$$\norm{x_m - x'_m}<\frac{1}{m} \mbox{ и } \|f(x_m) - f(x'_m)\|\geq \varepsilon_0 >0$$
за всяко естествено $m$. Тъй като $K$ е компакт, съществува сходяща подредица $x_{m_k} \xrightarrow[k \rightarrow \infty]{} x_0 \in K$ на $\{x_m\}_{m=1}^\infty \subset K$. От неравенствата
$$\norm{x'_{m_k}-x_0}\leq \norm{x'_{m_k}-x_{m_k}} + \norm{x_{m_k} - x_0} < \frac{1}{m_k} + \norm{x_{m_k}-x_0}$$
получаваме, че редицата $\{x'_{m_k}\}_{k=1}^\infty$ също клони към точката $x_0\in K$. Сега използваме непрекъснатостта
на $f$ в точката $x_0\in K$ и получаваме, че
$$f(x_{m_k}) \xrightarrow[k \rightarrow \infty]{} f(x_0)\mbox{ и } f(x_{m_k}') \xrightarrow[k \rightarrow \infty]{} f(x_0) .$$
Като извадим тези две редици, получаваме
$f(x_{m_k}) - f(x'_{m_k}) \xrightarrow[k \rightarrow \infty]{} 0$, което противоречи на $\|f(x_m) - f(x'_m)\|\geq \varepsilon_0 >0$ за всяко естествено $m$. Теоремата е доказана.
\end{proof}

\section{Лекция 2: Кратен Риманов интеграл - въвеждане и основни свойства}

Конструкцията на Дарбу, с която сте въвели Риманов интеграл в курса по ДИС1, е важна и естествена и ние ще я използваме отново, за да въведем $n$-кратен Риманов интеграл. Геометричната интуиция остава същата. В курса по ДИС1 сте искали да дефинирате по един разумен начин лицето на фигура, заградена от абцисата, две вертикални прави и графиката на ограничена неотрицателна функция. Постигнали сте го чрез оценяване отгоре и отдолу на това лице чрез лицата на стъпаловидни фигури, съставени от краен брой правоъгълници (тези лица са големите и малките суми на Дарбу). Сега за $n$=2 трябва да оценяваме отгоре и отдолу обема на тяло, заградено от равнината на първите две координатни оси, вертикални равнини по границата на даден правоъгълник и графиката на ограничена неотрицателна функция, дефинирана в този правоъгълник. Оценката е чрез обема на тела, състоящи се от краен брой паралелепипеди (за оценка отгоре вземаме обема на такова стъпаловидно тяло, съдържащо нашето, а за оценка отдолу - съдържащо се в нашето). За по-големи размерности идеята и конструкцията остават същите, само че вече не можем да нарисуваме подходяща картинка.

\subsection{Паралелотопи в $\R^n$ и тяхната мярка}

Първият въпрос, който трябва да решим, е с какво заменяме крайния и затворен интервал от ДИС1, ако размерността е по-голяма от едно. Естественият отговор е: с правоъгълник в равнината, с паралелепипед в тримерното пространство и т.н.

\begin{defn}
Паралелотоп (на английски interval, box) е множество в $\R^n$, за което всяка координата се мени (независимо от останалите) в краен затворен интервал:
$$\Delta := \{x\in\R^n : a_i \leq x_i \leq b_i,\; i = 1, 2, ... n \} \ .$$
\end{defn}

За различните размерности (стойности на $n$) имаме

\begin{tabular}{ c l }
  $n$ & \multicolumn{1}{c}{$\Delta$}\\
  \hline
  1 & $[a_1, b_1]$ \mbox{ интервал }\\
  2 & $[a_1, b_1]\times[a_2, b_2]$ \mbox{ правоъгълник }\\
  3 & $[a_1, b_1]\times[a_2, b_2]\times[a_3, b_3]$\mbox{ парарелепипед }\\
  ..& ...
\end{tabular}

Същественото за тези най-прости фигури е, че нямаме съмнения какво трябва да наречем дължина на интервал, лице на правоъгълник, обем на паралелепипед, а за паралелотоп в $\R^n$ естествено въвеждаме мярка в $\R^n$.

\begin{defn}
За паралелотопа $\Delta = \{x\in\R^n : a_i \leq x_i \leq b_i,\; i = 1, 2, ... n \}$ дефинираме неговата $n$-мерна мярка като
$$\mu_n(\Delta) := \prod_{i=1}^n (b_i - a_i) \ .$$
\end{defn}

Забележете, че при $n=1$ това е дължината $\mu_1([a_1,b_1]) = b_1 - a_1$ на интервала $[a_1,b_1]$, при $n=2$ това е лицето $\mu_2([a_1,b_1]\times [a_2,b_2]) = (b_1 - a_1)(b_2-a_2)$ на правоъгълника $[a_1, b_1]\times[a_2, b_2]$, при $n=3$ това е обемът $\mu_3([a_1, b_1]\times[a_2, b_2]\times[a_3, b_3]) = (b_1 - a_1)(b_2-a_2)(b_3-a_3)$ на паралелепипеда $[a_1, b_1]\times[a_2, b_2]\times[a_3, b_3]$.

Един паралелотоп ще наричаме изроден, ако някой от интервалите $[a_i, b_i]$ се изражда в точка, т.е. $a_i=b_i$. В такава ситуация $n$-мерната мярка на паралелотопа е нула. Например отсечка върху абцисата може да бъде разглеждана като паралелотоп в $\R^1$ и ще има ненулева дължина, но ако бъде разглеждана като паралелотоп в $\R^2$, ще има лице нула.


\bigskip

Следващият етап е да уточним как да разделяме паралелотоп на паралелотопчета по аналогия с разделянето на интервал на подинтервали от ДИС1. Неформално, подразделяне на паралелотоп са краен брой паралелотопи, чието обединение е първоначалният паралелотоп, и които не се припокриват.

\begin{defn}
Подразделение $\Pi$ на един паралелотоп $\Delta$ е крайно множество от паралелотопи
$\Pi = \{\Delta_k \}_{k=1}^{k_0}$, за което
 $\cup_{k=1}^{k_0} \Delta_k = \Delta$ и $\mathring \Delta_{k} \cap \mathring \Delta_{l} = \emptyset \; \forall k \neq l$.
\end{defn}

\begin{center}
\begin{tikzpicture}
\draw (0,0) -- (5,0) --(5,3) --(0,3) --cycle;
\draw[dashed] (0,0) grid (5,3);
\draw[thick] (0,0) --(1,0)--(1,2)--(0,2)--cycle;
\draw[thick] (4,3) --(3,3)--(3,1)--(4,1)--cycle;
\draw[thick] (1,3)--(1,2);
\draw[thick] (2,3)--(2,0);
\draw[thick] (2,1)--(5,1);
\draw[thick] (0,2) rectangle (1,3);
\draw[thick] (1,0) rectangle (2,3);
\draw[thick] (2,0) rectangle (5,1);
\draw[thick] (4,1) rectangle (5,3);
\draw[thick] (2,1) rectangle (3,3);
\end{tikzpicture}
\end{center}

Забележете, че вътрешността на паралелотопа $\Delta = \{x\in\R^n : a_i \leq x_i \leq b_i,\; i = 1, 2, ... n \}$ е множеството $\mathring \Delta = \{x\in\R^n : a_i < x_i < b_i, \; i=1,2,..n\}$. Следното твърдение е геометрически очевидно, но съществено за по-нататъшната ни работа:

\begin{prop}\label{partitioning}
Ако $\Pi = \{\Delta_k \}_{k=1}^{k_0}$ е подразделяне на $\Delta$, то $\mu_n(\Delta) = \sum_{k=1}^{k_0} \mu_n(\Delta_k)$.
\end{prop}

\begin{proof}
Първо разглеждаме случая на правилно подразделяне, т.е. $\Pi$ се получава като се раздели интервалът, в който се мени $i$-тата координата, на подинтервали за всяко $i$, и се вземат всевъзможните декартови произведения на такива подинтервали.
За пестене на място и по-прости означения ще изпишем нещата за $n=2$, в общия случай доказателството е аналогично. И тъй, нека
$\Delta =[a_1,b_1]\times [a_2,b_2]$ и делим $[a_1,b_1]$ и $[a_2,b_2]$ на подинтервали:
$$a_1 = x_0 < x_1 < ... < x_{m_0} = b_1 \ ,$$
$$a_2 = y_0 < y_1 < ... < y_{l_0} = b_2 \ .$$
Тогава $\Pi = \{\Delta_{m l} : \ m=1,\dots ,m_0, \ l=1, \dots ,l_0\}$, където
$\Delta_{m l} = [x_{m-1}, x_m]\times [y_{l-1}, y_l]$. Пресмятаме
\begin{dmath*}
\sum_{l=1}^{l_0} \sum_{m=1}^{m_0} \mu_2 (\Delta_{m l}) = \sum_{l=1}^{l_0} \sum_{m=1}^{m_0} (x_m - x_{m-1})(y_l - y_{l-1}) = \sum_{l=1}^{l_0} (y_l - y_{l-1})\sum_{m=1}^{m_0} (x_m - x_{m-1}) = (b_1 - a_1) \sum_{l=1}^{l_0}(y_l - y_{l-1}) = (b_1 - a_1) (b_2 - a_2) = \mu_2(\Delta)
\end{dmath*}

Нека сега да разгледаме произволно подразделяне $\Pi = \{\Delta_k \}_{k=1}^{k_0}$. Можем да намерим правилно подразделяне $\Pi^*$ на $\Delta$ такова, че елементите на $\Pi^*=\{\Delta_l^* \}_{l=1}^{l_0}$, които се съдържат в $\Delta_k$, образуват подразделяне на $\Delta_k$ (например при размерност 2 продължаваме вертикалните и хоризонтални страни на правоъгълниците от $\Pi$ в целите интервали). Тогава, използвайки два пъти предишната стъпка, получаваме
$$\mu_n(\Delta) = \sum_{l=1}^{l_0} \mu_n(\Delta_l^*)= \sum_{k=1}^{k_0} \left(\sum_{\Delta_l^*\subset \Delta_k} \mu_n(\Delta_l^*)\right)=\sum_{k=1}^{k_0} \mu_n(\Delta_k) \ .$$
\end{proof}

В горното доказателство намерихме "подразделяне $\Pi^*$ на $\Delta$ такова, че елементите на $\Pi^*=\{\Delta_l^* \}_{l=1}^{l_0}$, които се съдържат в $\Delta_k$, образуват подразделяне на $\Delta_k$". В такава ситуация казваме, че $\Pi^*$ е по-фино (или по-дребно) от $\Pi$. Формално

\begin{defn}
Нека $\Pi = \{\Delta_k \}_{k=1}^{k_0}$ и $\Pi^* = \{\Delta_l^* \}_{l=1}^{l_0}$ са две подразделяния на паралелотопа $\Delta$. Казваме, че $\Pi^*$ е по-фино от $\Pi$ (или $\Pi^*$ е вписано в $\Pi$) и пишем $\Pi^* \ge \Pi$, ако
$$\left\{ \Delta_l^* : \ \Delta_l^* \subset \Delta_k\right\}$$
е подразделяне на $\Delta_k$ за всяко $k=1,2, \dots, k_0$.
\end{defn}

\subsection{Въвеждане на Риманов интеграл чрез подхода на Дарбу}

В целия параграф ще разглеждаме дадена ограничена функция $f:\Delta \rightarrow \R$, където $\Delta$ е паралелотоп в $\R^n$.

 Нека $\Pi = \{\Delta_i \}_{i=1}^{i_0}$ е произволно подразделяне на $\Delta$. По аналогия с едномерния случай дефинираме
$$s_f(\Pi) = \sum_{i=1}^{i_0} m_i \mu_n(\Delta_i)\mbox{, където }m_i = \inf\{f(x) : x\in\Delta_i\} \ , \  i=1, \dots ,i_0 \ .$$
Числото $s_f(\Pi)$ наричаме \textit{малка сума на Дарбу} за функцията $f$, съответстваща на подразделянето $\Pi$. Интуитивно това число е долна оценка за интеграла, който искаме да въведем.

Аналогично
$$S_f(\Pi) = \sum_{i=1}^{i_0} M_i \mu_n(\Delta_i)\mbox{, където }M_i = \sup\{f(x) : x\in\Delta_i\} \ , \  i=1, \dots ,i_0 \ .$$
Сега числото $S_f(\Pi)$ наричаме \textit{голяма сума на Дарбу} за функцията $f$, съответстваща на подразделянето $\Pi$. Интуитивно това число е горна оценка за търсения "обем".

Следните две леми точно съответстват на доказаните в ДИС1. Интуитивно, първата лема казва, че оценките, съответстващи на по-дребно подразделяне, са по-точни (горната оценка намалява, а долната се увеличава). Втората лема казва, че всяка долна оценка не надминава коя да е горна оценка, както и би трябвало да бъде.


\begin{lem}
Ако $\Pi^* \geq \Pi$, то $s_f(\Pi^*)\geq s_f(\Pi)$ и $S_f(\Pi^*)\leq S_f(\Pi)$.
\end{lem}

\begin{proof}
Без ограничение на общността, нека $\Pi = \{\Delta_i\}_{i=1}^{i_0}$ и $\Pi^* = \{\Delta_1^j\}_{j=1}^{j_0} \cup \{\Delta_i\}_{i=2}^{i_0}$, т.е. $\Pi^*$ се получава от $\Pi$ чрез подразделяне $\{\Delta_1^j\}_{j=1}^{j_0}$ на първия елемент $\Delta_1$ на $\Pi$. Да означим $m_i = \inf\{f(x) : x\in\Delta_i\}$ за $i=1, \dots ,i_0$, $m_1^j=\inf\{f(x) : x\in\Delta_1^j\}$ за $j=1, \dots ,j_0$. Забележете, че $m_1\le m_1^j$ за всяко $j=1, \dots ,j_0$, защото $\Delta_1^j \subset \Delta_1$. Оттук получаваме, че
\begin{dmath*}
s_f(\Pi^*)-s_f(\Pi) = \sum_{j=1}^{j_0} m_1^j \mu_n(\Delta_1^j) +\sum_{i=2}^{i_0} m_i \mu_n(\Delta_i) -\sum_{i=1}^{i_0} m_i \mu_n(\Delta_i)=  \sum_{j=1}^{j_0} m_1^j \mu_n(\Delta_1^j) - m_1 \mu_n(\Delta_1)\ge  \sum_{j=1}^{j_0} m_1 \mu_n(\Delta_1^j)  - m_1 \mu_n(\Delta_1) = m_1 \left( \sum_{j=1}^{j_0} \mu_n(\Delta_1^j)-\mu_n(\Delta_1)\right)=0
\end{dmath*}
поради Твърдение \ref{partitioning}.

Аналогично доказваме, че $S_f(\Pi^*)\leq S_f(\Pi)$.
\end{proof}

\begin{lem}\label{lemma2}
За произволни подразделяния $\Pi_1$ и $\Pi_2$ на $\Delta$ е в сила
$s_f(\Pi_1)\leq S_f(\Pi_2)$.
\end{lem}

\begin{proof}
Нека $\Pi^* \geq \Pi_1$, $\Pi^* \geq \Pi_2$ (ясно е, че такова подразбиване $\Pi^*$ на $\Delta$ съществува - например може да се вземе множеството от неизродените паралелотопи, получени като сечение на елемент от $\Pi_1$ с елемент от $\Pi_2$). Тогава $$s_f(\Pi_1) \leq s_f(\Pi^*)\leq S_f(\Pi^*) \leq S_f(\Pi_2) \ ,$$
като първото и последното неравенство се получават от предишната лема, а средното неравенство се получава от очевидното съображение, че инфимумът на множество от реални числа не надминава неговия супремум, и от дефиницията на малка и голяма сума на Дарбу.
\end{proof}

Тъй като функцията $f$ е ограничена, множеството от всевъзможните малки суми на Дарбу (както и множеството от всевъзможните големи суми на Дарбу) на $f$ е ограничено и следователно можем да дефинираме \textit{долен интеграл} на $f$ върху $\Delta$
$$\underline{\int}_\Delta f :=\sup\left\{ s_f(\Pi): \Pi \mbox{ е подразделяне на }\Delta\right\}$$
и \textit{горен интеграл} на $f$ върху $\Delta$
$$\overline{\int}_\Delta f :=\inf\left\{ S_f(\Pi): \Pi \mbox{ е подразделяне на }\Delta\right\} \ .$$

Да отбележим, че от Лема \ref{lemma2} следва, че при произволно фиксирано поразделяне $\Pi$ на $\Delta$ е в сила $\underline{\int}_\Delta f \le S_f(\Pi)$, откъдето следва неравенството $\underline{\int}_\Delta f \le \overline{\int}_\Delta f$.
\begin{defn} Функцията
$f$ се нарича интегруема по Риман, когато долният и горният интеграл на $f$ върху $\Delta$ съвпадат (или еквивалентно съществува единствено число, разделящо малките от големите суми на Дарбу). Тогава общата стойност на долния и горния интеграл на $f$ върху $\Delta$ се нарича интеграл на $f$ върху $\Delta$ и се означава с $\int_\Delta f$ или $\int_\Delta f(x) \textrm{d}x$.
\end{defn}
Други разпространени означения в съответните размерности са

$n=1 \quad \int_{[a,b]} f(x) \textrm{d}x = \int_{a}^b f(x) \textrm{d}x$

$n=2 \quad \iint_{\Delta} f(x_1, x_2) \textrm{d}x_1 \textrm{d}x_2$

$n=3 \quad \iiint_{\Delta} f(x_1, x_2, x_3) \textrm{d}x_1 \textrm{d}x_2 \textrm{d}x_3$

\bigskip

Следният критерий за интегруемост се формулира и доказва точно като в курса по ДИС1:

\begin{prop} (Първа форма на критерия за интегруемост) Функцията $f$ е интегруема по Риман върху $\Delta$ точно тогава, когато за всяко положително число $\varepsilon$ съществуват подразделяния $\Pi_1$ и $\Pi_2$ на $\Delta$ такива, че $S_f(\Pi_1)-s_f(\Pi_2)<\varepsilon$. Еквивалентно, $f$ е интегруема по Риман върху $\Delta$ точно тогава, когато за всяко положително число $\varepsilon$ съществува подразделяне $\Pi$ на $\Delta$ такова, че $S_f(\Pi)-s_f(\Pi)<\varepsilon$.
\end{prop}

Следващото твърдение е ново (т.е. не сте правили подобно в ДИС1) и ни е необходимо с оглед доказателството на критерия на Лебег.

\begin{prop}\label{second_criterium} 
(Втора форма на критерия за интегруемост) Функцията $f$ е интегруема по Риман върху $\Delta$ точно тогава, когато за всяко положително число $\varepsilon$ и за всяко положително число $\eta$ съществува подразделяне $\Pi$ на $\Delta$ такова, че сумата от мерките на елементите на $\Pi$, в които осцилацията на $f$ е по-голяма или равна на $\eta$, е по-малка от $\varepsilon$. Формално записано, за всяко $\varepsilon>0$ и за всяко $\eta>0$ съществува подразделяне $\Pi = \{\Delta_i \}_{i=1}^{i_0}$, за което
$$\sum_{M_i-m_i\geq \eta} \mu_n(\Delta_i)<\varepsilon \ .$$
\end{prop}
\begin{proof}
Нека $f$ е интегруема по Риман върху $\Delta$ и $\varepsilon>0$ и $\eta>0$ са произволни положителни числа. Тогава от първата форма на критерия за интегруемост следва, че съществува подразделяне $\Pi$ на $\Delta$ такова, че $S_f(\Pi)-s_f(\Pi)<\varepsilon \eta$. Нека $\Pi = \{\Delta_i \}_{i=1}^{i_0}$ и $m_i$, $M_i$ са дефинирани както обикновено. Тогава
$$\varepsilon\eta > S_f(\Pi)-s_f(\Pi) = \sum_{i=1}^{i_0} M_i \mu_n(\Delta_i) -\sum_{i=1}^{i_0} m_i \mu_n(\Delta_i) =
\sum_{i=1}^{i_0} \left(M_i -m_i\right) \mu_n(\Delta_i)$$
$$= \sum_{M_i-m_i< \eta}\left(M_i -m_i\right) \mu_n(\Delta_i) +\sum_{M_i-m_i\geq \eta}\left(M_i -m_i\right) \mu_n(\Delta_i)$$
$$\ge \sum_{M_i-m_i\geq \eta}\left(M_i -m_i\right) \mu_n(\Delta_i) \ge \sum_{M_i-m_i\geq \eta}\eta \mu_n(\Delta_i) = \eta \sum_{M_i-m_i\geq \eta} \mu_n(\Delta_i)$$
Съкращаваме на $\eta$ и получаваме търсеното неравенство за така намереното подразделяне $\Pi$ на $\Delta$.

Сега обратно, нека е в сила условието от критерия и искаме да докажем, че $f$ е интегруема. За целта избираме произволно положително число $\zeta$ и ще търсим подразбиване $\Pi$ на $\Delta$, за което разстоянието между съответната голяма и малка сума на Дарбу е по-малка от $\zeta$. Това би решило въпроса според първата форма на критерия за интегруемост. Ще намерим $\Pi$ от даденото условие с достатъчно малки (зависещи от $\zeta$) $\varepsilon>0$ и $\eta>0$. Ще се сетим колко малки трябва да изберем тези числа, след като оценим разликата между съответните голяма и малка сума на Дарбу по подобен начин като преди, само че отгоре:
$$S_f(\Pi)-s_f(\Pi) =
\sum_{M_i-m_i< \eta}\left(M_i -m_i\right) \mu_n(\Delta_i) +\sum_{M_i-m_i\geq \eta}\left(M_i -m_i\right) \mu_n(\Delta_i)$$
$$\le \eta \sum_{M_i-m_i< \eta} \mu_n(\Delta_i) + (M-m)\sum_{M_i-m_i\geq \eta}\mu_n(\Delta_i) <
\eta \mu_n(\Delta) + \varepsilon (M-m) \ ,$$
където $M:=\sup\{ f(x):x\in \Delta\}$ и $m:=\inf\{ f(x):x\in \Delta\}$. Следователно ако изберем
$$\varepsilon := \frac{\zeta}{2(M-m)} \mbox{ и } \eta :=\frac{\zeta}{2\mu_n(\Delta)} \ ,$$
за подразбиването $\Pi$ на $\Delta$, получено от даденото условие, е в сила $S_f(\Pi)-s_f(\Pi)<\zeta$.
\end{proof}

\subsection{Суми на Риман и граница на суми на Риман}

Сумите на Риман се дефинират точно по същия начин като в курса по ДИС1.
Те се различават от сумите на Дарбу по това, мярката на съответното паралелотопче се умножава по стойността на функцията в произволна пробна точка (sample point) от него (а не по супремума или инфимума на стойностите на функцията в паралелотопчето). Да отбележим, че няма проблем да дефинираме суми на Риман и за неограничена функция.

И тъй, нека $\Delta$ е паралелотоп в $\R^n$ и $f:\Delta \rightarrow \R$.

Фиксираме подразбиване $\Pi = \{\Delta_i \}_{i=1}^{i_0}$ на $\Delta$ и избираме пробни точки $\xi = \{\xi_1, \xi_2, \dots , \xi_{i_0}\}$, където $\xi_i \in \Delta_i$ за всяко $i=1,\dots ,i_0$. Тогава числото
$$\sigma_f(\Pi, \xi) := \sum_{i=1}^{i_0}f(\xi_i)\mu_n(\Delta_i)$$
наричаме \textit{сума на Риман} на функцията $f$ за подразбиването $\Pi$ с пробни точки $\xi$.

\begin{prop}\label{RiemannDarboux}
Нека $f:\Delta \rightarrow \R$ е ограничена и $\Pi$ е подразбиване на $\Delta$. Тогава
$$s_f(\Pi)=\inf\{\sigma_f(\Pi, \xi): \ \xi \mbox{ са пробни точки за } \Pi\}$$
$$S_f(\Pi) = \sup\{\sigma_f(\Pi, \xi): \ \xi \mbox{ са пробни точки за } \Pi\}$$
\end{prop}

\begin{proof}
Очевидно
$m_i = \inf\{f(x) : x\in\Delta_i\}\le f(\xi_i) \le  \sup\{f(x) : x\in\Delta_i\}=M_i$ за всяко $i=1,\dots ,i_0$ и за всеки избор на пробните точки $\xi$. Умножавайки тези неравенства с $\mu_n(\Delta_i)$ и събирайки ги, получаваме $s_f(\Pi)\le \sigma_f(\Pi, \xi)\le S_f(\Pi)$. Следователно малката (голямата) сума на Дарбу за $\Pi$ е долна (горна) граница за сумите на Риман за същото подразбиване. Да проверим например, че малката сума на Дарбу за $\Pi$ е точна долна граница за сумите на Риман за $\Pi$. Избираме произволно $\varepsilon >0$ и от $m_i +\frac{\varepsilon}{i_0\mu_n(\Delta_i)} >m_i$ намираме $\xi_i\in \Delta_i$ с $f(\xi_i) < m_i +\frac{\varepsilon}{i_0\mu_n(\Delta_i)}$ за всяко $i=1,\dots ,i_0$. За така намерените пробни точки $\xi = \{\xi_1, \xi_2, \dots , \xi_{i_0}\}$ имаме
$$\sigma_f(\Pi, \xi) = \sum_{i=1}^{i_0}f(\xi_i)\mu_n(\Delta_i)< \sum_{i=1}^{i_0}\left( m_i +\frac{\varepsilon}{i_0\mu_n(\Delta_i)}\right)\mu_n(\Delta_i)= s_f(\Pi)+\varepsilon \ ,$$
следователно всяко число, по-голямо от $s_f(\Pi)$, вече не е долна граница за сумите на Риман за $\Pi$.
\end{proof}

За да можем да пренесем идеята за граница на суми на Риман от едномерния в многомерния случай, се нуждаем от подходяща дефиниция на диаметър на подразбиване. Да напомним, че ако $A$ е ограничено подмножество на $\R^n$, то
диаметър на $A$ наричаме числото
 $$\textrm{diam}(A) = \sup\{\norm{x-y}:\ x\in A, \ y\in A\} \ .$$


\begin{defn} Нека $\Pi = \{\Delta_i \}_{i=1}^{i_0}$ е подразбиване на паралелотопа $\Delta$. Диаметър на $\Pi$ наричаме най-големия от диаметрите на паралелотопите от $\Pi$:
$$\textrm{d}(\Pi) = \max\{\textrm{diam}(\Delta_i) : \  i=1,2,\dots ,i_0\}$$
\end{defn}

\begin{defn}
Казваме, че сумите на Риман за функцията $f:\Delta \rightarrow \R$ имат граница числото $I$, когато диаметърът на подразбиването клони към нула, и пишем
$$\lim_{d(\Pi)\rightarrow 0} \sigma_f(\Pi, \xi)=I \ ,$$
 ако за всяко $\varepsilon >0$ съществува $\delta >0$ такова, че за всяко подразбиване $\Pi$ на $\Delta$ с $\textrm{d}(\Pi)<\delta$ и при всеки избор на пробните точки $\xi$ за $\Pi$ е в сила $\left| \sigma_f(\Pi ,\xi )-I\right| <\varepsilon$.
\end{defn}

\subsection{Еквивалентност на подхода чрез суми на Дарбу и на подхода чрез суми на Риман}

\begin{thm}\label{easy_equivalence}
Нека $f:\Delta\rightarrow\R$, където $\Delta \subset \R^n$ е паралелотоп, и нека сумите на Риман за $f$ имат граница $I$, когато диаметърът на подразбиването клони към нула. Тогава функцията $f$ е ограничена, интегруема по Риман и $I = \int_\Delta f$.
\end{thm}

\begin{proof}
Нека $\varepsilon=1>0$. Тогава съществува $\delta>0$ такова, че за всички подразбивания $\Pi$ с $\textrm{d}(\Pi)<\delta$ и при всеки избор на пробните точки $\xi$ за $\Pi$ е в сила $I-1 < \sigma_f(\Pi, \xi)<I+1$. Да фиксираме произвално подразбиване $\Pi = \{\Delta_i \}_{i=1}^{i_0}$ с диаметър, по-малък от $\delta$. Ще докажем, че функцията е ограничена върху всеки елемент на $\Pi$.

Да фиксираме $i\in \{ 1,\dots ,i_0\}$ и някакви точки $\xi_j\in \Delta_j$ за всяко $j\neq i$, $j\in \{ 1,\dots ,i_0\}$. Тогава получаваме, че
$$\frac{(I-1)-\sum_{j\neq i} f(\xi_j) \mu_n(\Delta_j)}{\mu_n(\Delta_i)} < f(\xi_i) < \frac{(I+1) - \sum_{j\neq i} f(\xi_j)\mu_n(\Delta_j)}{\mu_n(\Delta_i)}$$
за всяко $\xi_i\in \Delta_i$. Следователно $f$ е ограничена върху $\Delta_i$, $i\in \{ 1,\dots ,i_0\}$. С това ограничеността на $f$ е доказана, защото подразбиването $\Pi$ има краен брой елементи.

Нека $\varepsilon$ е произволно положително число. Тогава съществува $\delta >0$ такова, че за всяко подразбиване $\Pi$ на $\Delta$ с $\textrm{d}(\Pi)<\delta$ и при всеки избор на пробните точки $\xi$ за $\Pi$ е в сила $I-\frac{\varepsilon}{3} < \sigma_f(\Pi, \xi)<I+\frac{\varepsilon}{3}$. Използвайки това и Твърдение \ref{RiemannDarboux}, получаваме
$$I-\frac{\varepsilon}{3} \le s_f(\Pi) \le S_f(\Pi) \le I+\frac{\varepsilon}{3} \ .$$
Следователно
$$S_f(\Pi)-s_f(\Pi)\le \left( I+\frac{\varepsilon}{3}\right)-\left( I-\frac{\varepsilon}{3}\right)=\frac{2\varepsilon}{3}< \varepsilon$$
и получаваме интегруемостта на $f$ от първата форма на критерия за интегруемост. Нещо повече, от горните неравенства и от факта, че $\int_\Delta f$ се намира между $s_f(\Pi)$ и $S_f(\Pi)$, получаваме, че $I-\frac{\varepsilon}{3} \le\int_\Delta f\le I+\frac{\varepsilon}{3}$ и тъй като $\varepsilon$ беше произволно положително число, то $\int_\Delta f =I$.
\end{proof}

\bigskip

\begin{thm}\label{hard_equivalence}
Нека $f:\Delta\rightarrow\R$, където $\Delta \subset \R^n$ е паралелотоп, е интегруема по Риман. Тогава сумите на Риман за $f$ имат граница $\int_\Delta f$, когато диаметърът на подразбиването клони към нула.
\end{thm}

\begin{proof}
Нека $\varepsilon > 0$ е произволно. Ако докажем, че съществува $\delta >0$ такова, че за всяко подразбиване $\Pi$ на $\Delta$ с $\textrm{d}(\Pi)<\delta$ е в сила $I-\varepsilon < s_f(\Pi) \leq S_f(\Pi) < I+\varepsilon$, доказателството ще е завършено, защото при произволен избор на представителните точки $\xi$ имаме
$s_f(\Pi) \leq \sigma_f(\Pi, \xi) \leq S_f(\Pi)$
и следователно от горните неравенства получаваме $|\sigma_f(\Pi, \xi) - I|<\varepsilon$ .

И така $\varepsilon > 0$. От дефиницията за интеграл на Риман следва, че съществува $\Pi_1 = \{\Box_j \}_{j=1}^{j_0}$ подразделяне на $\Delta$ такова, че
$$S_f(\Pi_1) < I+\frac{\varepsilon}{2} \ .$$
От $f$ интегруема следва, че $f$ е  ограничена. Нека $M = \sup\{|f(x)|: x\in\Delta\}$. Означаваме с  $P_{\Pi_1}$  общата площ на границите на паралелотопчетата от $\Pi_1$, т.е.
$P_{\Pi_1}:= \Sigma_{j=1}^{j_0} \mu_{n-1}\left(\partial \Box_j\right)$. Полагаме $$\delta = \frac{\varepsilon}{8MP_{\Pi_1}}>0 \ .$$  Искаме да оценим $S_f(\Pi)$, където $\Pi =\{\Delta_i \}_{i=1}^{i_0}$ е произволно подразбиване на $\Delta$ с диаметър, по-малък от $\delta$.

Нека сега $\Pi_2$ да е подразбиване на $\Delta$, съставено от сеченията на елементите на $\Pi$ и $\Pi_1$, т.е. $\Pi_2 = \{\Box_j \cap \Delta_i \}_{i=1 \; j=1}^{i_0 \quad j_0}$ и след това изхвърляме празните множества. Тогава $$d(\Pi_2) \leq d(\Pi) < \delta \ .$$ Тъй като $\Pi_2 \ge \Pi_1$, то $$S_f(\Pi_2) \leq S_f(\Pi_1) < I + \frac{\varepsilon}{2} \ .$$  Ще оценим отгоре $S_f(\Pi) - S_f(\Pi_2)$. Делим елементите на $\Pi$ на две групи - които се секат с границата на някой елемент на $\Pi_1$ и които се съдържат изцяло във вътрешността на елемент на $\Pi_1$. Събираемите, съответстващи на елементите от втория вид, участват както в $S_f(\Pi)$, така и в $S_f(\Pi_2)$ и се съкращават. Нека индексите на елементите на $\Pi$ от първия вид са $I_1 \subset \{1, 2, ..., i_0 \}$ .

Тогава
\begin{dmath*}
S_f(\Pi) - S_f(\Pi_2) = \sum_{i\in I_1} M_i \mu_n (\Delta_i) - \sum_{i\in I_1} \sum_{j=1}^{j_0} M_{ij} \mu_n (\Delta_i\cap \Box_j) \ ,
\end{dmath*}
където, разбира се, $M_i=\sup\{ f(x): \ x\in \Delta_i\}$ и $M_{ij}=\sup\{ f(x): \ x\in \Delta_i\cap \Box_j\}$. Тъй като
$\textrm{diam}(\Delta_i)<\delta$, то $\sum_{i\in I_1} \mu_n (\Delta_i) \leq 2 \delta P_{\Pi_1}$ и следователно $$\left|\sum_{i\in I_1} M_i \mu_n (\Delta_i)\right|\leq \sum_{i\in I_1} \left| M_i\right| \mu_n (\Delta_i) \le M 2 \delta P_{\Pi_1} \ .$$

Аналогично
$\sum_{i\in I_1} \sum_{j=1}^{j_0} \mu_n (\Delta_i\cap \Box_j)\leq 2 \delta P_{\Pi_1}$ влече $$\left|\sum_{i\in I_1} \sum_{j=1}^{j_0} M_{ij} \mu_n (\Delta_i\cap \Box_j)\right| \leq M 2 \delta  P_{\Pi_1} \ .$$

Следователно
$$
S_f(\Pi) - S_f(\Pi_2) \leq \left|\sum_{i\in I_1} M_i \mu_n (\Delta_i)\right| + \left|\sum_{i\in I_1} \sum_{j=1}^{j_0} M_{ij} \mu_n (\Delta_i\cap \Box_j)\right| \leq 4M P_{\Pi_1} \delta =  \frac{\varepsilon}{2} \ .
$$

Тогава имаме
$$
S_f(\Pi) = (S_f(\Pi) - S_f(\Pi_2)) + S_f(\Pi_2) \leq \frac{\varepsilon}{2} + S_f(\Pi_2) < \frac{\varepsilon}{2} + I + \frac{\varepsilon}{2} = I+\varepsilon \ .
$$

Аналогично доказваме, че $s_f(\Pi) > I-\varepsilon$ за всички $\Pi$ с достатъчно малък диаметър, с което доказателството е завършено.
\end{proof}

\newpage

\section{Лекция 3: Множества, пренебрежими по Лебег и критерий на Лебег за интегруемост по Риман}

Целта на тази лекция е да докажем необходимо и достатъчно условие за интегруемост по Риман, което свързва интегруемостта с "големината" на множеството от точките на непрекъснатост на функцията. За да можем да формулираме точно критерия, се нуждаем от понятието "множество, пренебрежимо по Лебег". Само по себе си това понятие е изключително важно, затова ще отделим време за неговото изучаване. 

\subsection{Множества, пренебрежими по Лебег}

\begin{defn} Едно подмножество $A$ на $\R^n$ наричаме \textit{пренебрежимо по Лебег} в $\R^n$, ако за всяко положително $\varepsilon$ можем да покрием множеството с изброимо много паралелотопи, чиято сумарна мярка е по-малка от $\varepsilon$. Формално записано, за произволно
$\varepsilon > 0$ съществуват $\{\Delta_k \}_{k=1}^\infty$ (където $\Delta_k$ са затворени паралелотопи в $\R^n$) такива, че $$\bigcup_{k=1}^\infty \Delta_k \supset A  \mbox{ и } \sum_{k=1}^\infty \mu_n(\Delta_k)<\varepsilon \ .$$
\end{defn}

\begin{example}
Изродените паралелотопи са пренебрежими множества.
Точките са изродени паралелотопи в $\R^n$ за всяко естествено $n$ и следователно са пренебрежими множества.
\end{example}

Очевидно е, че подмножество на пренебрежимо множество е пренебрежимо. Следващото твърдение съдържа едно от най-важните и често употребявани свойства на множествата, пренебрежими по Лебег:
\begin{prop}
Ако $\{A_m\}_{m=1}^\infty$ е редица от пренебрежими множества, то обединението им $A$ също е пренебрежимо множество.
\end{prop}

\begin{proof} Да фиксираме произволно положителното число $\varepsilon$. Тъй като $A_1$ е пренебрежимо и $\varepsilon/2 >0$, то съществуват паралелотопи $\{ \Delta^1_k \ : \ k=1,2, \dots \}$ такива, че 
$$\bigcup_{k=1}^\infty \Delta_k^1 \supset A_1  \mbox{ и } \sum_{k=1}^\infty \mu_n(\Delta_k^1)<\frac{\varepsilon}{2} \ .$$
Аналогично постъпваме с множествата $A_2$, $A_3$ и т.н. За да фиксираме означенията, нека $m$ е естествено число. Тъй като $A_m$ е пренебрежимо и $\varepsilon/2^m >0$, то съществуват паралелотопи $\{ \Delta^m_k \ : \ k=1,2, \dots \}$ такива, че
$$\bigcup_{k=1}^\infty \Delta_k^m \supset A_m  \mbox{ и } \sum_{k=1}^\infty \mu_n(\Delta_k^m)<\frac{\varepsilon}{2^m} \ .$$
По този начин построихме паралелотопите $\{ \Delta^m_k \ : \ k=1,2, \dots , \ m=1, 2, \dots\}$. Те са изброимо много и очевидно
$$\bigcup_{m,k=1}^\infty \Delta^m_k =\bigcup_{m=1}^\infty \left( \bigcup_{k=1}^\infty \Delta^m_k\right)\supset 
\bigcup_{m=1}^\infty A_m = A \ .$$
От друга страна
$$\sum_{m,k=1}^\infty \mu_n\left(\Delta^m_k \right)=\sum_{m=1}^\infty \left( \sum_{k=1}^\infty \mu_n\left(\Delta^m_k \right)\right)< 
\sum_{m=1}^\infty \frac{\varepsilon}{2^m} = \varepsilon \ .$$
\end{proof}


\textbf{Важна забележка:} В последния ред от горното доказателство допуснахме липса на прецизност. За да бъдем точни, трябваше да подредим индексите $\{ (m,k): \ m\in \N, \ k\in \N\}$  в редица $\{ (\pi_1 (i), \pi_2(i)) : \ i\in \N \}$ и да разгледаме реда $\sum_{i=1}^\infty \mu_n\left(\Delta^{\pi_1 (i)}_{\pi_2(i)} \right)$. Всъщност, използвахме следното твърдение: Ако $a^m_k$ са неотрицателни числа за всички естествени индекси $m$ и $n$ и $\{ (\pi_1 (i), \pi_2(i)) : \ i\in \N \}$ е кое да е подреждане на $\N^2$ в редица, то
$$\sum_{i=1}^\infty a^{\pi_1 (i)}_{\pi_2(i)} =\sum_{m=1}^\infty \left( \sum_{k=1}^\infty a^m_k\right) \ .$$
Препоръчвам ви да се опитате да си докажете това твърдение сами.

\bigskip

\begin{example}
Тъй като точките са пренебрежими множества, горното твърдение влече, че множеството от рационалните числа $\Q$ е пренебрежимо в $\R$. Аналогично $\Q^n$ е пренебрежимо в $\R^n$.
\end{example}

\begin{prop}\label{negligibleinteriors}
Едно подмножество $A$ на $\R^n$ е пренебрежимо по Лебег в $\R^n$ точно тогава, когато за всяко положително $\varepsilon$ можем да покрием множеството с вътрешностите на изброимо много паралелотопи, чиято сумарна мярка е по-малка от $\varepsilon$. 
\end{prop}
\begin{proof}
В едната посока твърдението е очевидно. Нека сега $A$ е пренебрежимо по Лебег и $\varepsilon >0$ е произволно. Тогава съществуват $\{\Delta_k \}_{k=1}^\infty$ (където $\Delta_k$ са затворени паралелотопи в $\R^n$) такива, че $$\bigcup_{k=1}^\infty \Delta_k \supset A  \mbox{ и } \sum_{k=1}^\infty \mu_n(\Delta_k)<\frac{\varepsilon}{2} \ .$$
Да изберем ред с положителни членове $\alpha_k>0$ и сума $\varepsilon/2$, т.е. $\sum_{k=1}^\infty \alpha_k=\varepsilon/2$ (например можем да изберем като в доказателството на предишното твърдение $\alpha_k=\varepsilon/2^{k+1}$). Ясно е, че за всяко $k\in \N$ можем да намерим затворен паралелотоп $\Box_k$, който съдържа $\Delta_k$ във вътрешността си ($\mathring \Box_k \supset\Delta_k$) и такъв, че $\mu_n(\Box_k)\le \mu_n(\Delta_k)+\alpha_k$ (трябва да раздуем достатъчно малко всеки от координатните интервали). Тогава $\{\Box_k \}_{k=1}^\infty$ са изброимо много паралелотопи, за които
$$\bigcup_{k=1}^\infty \mathring \Box_k\supset \bigcup_{k=1}^\infty \Delta_k\supset A \mbox{ и } $$
$$\sum_{k=1}^\infty \mu_n(\Box_k)\le \sum_{k=1}^\infty (\mu_n(\Delta_k)+\alpha_k) =
\sum_{k=1}^\infty \mu_n(\Delta_k) +\sum_{k=1}^\infty \alpha_k <\frac{\varepsilon}{2}+\frac{\varepsilon}{2}=\varepsilon \ .$$
\end{proof}

Следващата лема е техническа и почти очевидна от геометрична гледна точка.

\begin{lem}\label{finitecover}
Нека $\{ \Delta_i\}_{i=1}^{i_0}$ са краен брой паралелотопи в $\R^n$, които не се припокриват, т.е. $\mathring \Delta_i \cap \mathring \Delta_j =\emptyset$  винаги, когато $i\not = j$. Нека $\{ \Box_k\}_{k=1}^{k_0}$ са краен брой паралелотопи, за които $\bigcup_{k=1}^{k_0} \Box_k \supset \bigcup_{i=1}^{i_0}\Delta_i$. Тогава $\sum_{k=1}^{k_0} \mu_n(\Box_k) \ge \sum_{i=1}^{i_0}\mu_n(\Delta_i)$.
\end{lem}
\begin{proof}
Нека $\Pi_i$ е подразбиване на $\Delta_i$, всеки елемент на което се съдържа в някой от паралелотопите $\{ \Box_k\}_{k=1}^{k_0}$ (тук $i=1,\dots ,i_0$). Сега за всяко $k\in \{ 1,\dots , k_0\}$ можем да построим подразбиване $\Pi^k$ на $\Box_k$ такова, че $$\Pi^k_i:=\{ \Delta_i\cap\Box \ : \ \Box\in \Pi^k, \ \Delta_i\cap\Box \mbox{ непразен, неизроден}\}\equiv \Pi_i \ , \ i=1,\dots ,i_0 \ .$$
Да забележим, че $\Pi^k_i \cap \Pi^k_j =\emptyset$  винаги, когато $i\not = j$, защото $\Delta_i$ и $\Delta_j$ не се припокриват. Тогава, използвайки два пъти Твърдение \ref{partitioning}, получаваме
$$\sum_{k=1}^{k_0} \mu_n(\Box_k) =\sum_{k=1}^{k_0} \left(\sum_{\Box\in\Pi^k}\mu_n(\Box)\right)\ge \sum_{k=1}^{k_0} \sum_{i=1}^{i_0}\left(\sum_{\Box\in\Pi^k_i}\mu_n(\Box)\right)\ge \sum_{i=1}^{i_0}\left(\sum_{\Box\in\Pi_i}\mu_n(\Box)\right)= \sum_{i=1}^{i_0}\mu_n(\Delta_i) .$$
\end{proof}

\begin{example}
Неизродените паралелотопи в $\R^n$ не са пренебрежими в $\R^n$. 

Наистина, един паралелотоп $\Delta$ в $\R^n$ е неизроден точно тогава, когато $\mu_n(\Delta)>0$. Сега ако допуснем, че $\Delta$ е пренебрежим, то според Твърдение \ref{negligibleinteriors} съществуват $\{\Delta_k \}_{k=1}^\infty$ (където $\Delta_k$ са паралелотопи в $\R^n$) такива, че $$\bigcup_{k=1}^\infty \mathring \Delta_k \supset \Delta  \mbox{ и } \sum_{k=1}^\infty \mu_n(\Delta_k)<\frac{\mu_n(\Delta)}{2} \ .$$
Тъй като $\Delta$ е компакт и $\{\mathring\Delta_k \}_{k=1}^\infty$ е негово отворено покритие, то съществува $k_0\in \N$ такова, че  $$\bigcup_{k=1}^{k_0} \mathring \Delta_k \supset \Delta \ .$$ Сега използваме горната лема с $\Delta$ единствен елемент на множеството от паралелотопите, които не се припокриват, и с $\Box_k:=\Delta_k$. Получаваме
$$\mu_n(\Delta) \le\sum_{k=1}^{k_0} \mu_n(\Delta_k) < \frac{\mu_n(\Delta)}{2} \ , \mbox{ противоречие.}$$
\end{example}

\begin{prop}
Ако $U$ е непразно отворено множество, то  $U$ не е пренебрежимо.
\end{prop}
\begin{proof}
Тъй като $U$ не е празно, можем да изберем точка $x_0\in U$. Тогава (от отвореността на $U$) съществува $\varepsilon >0$ такова, че кълбото $B_{2\varepsilon} (x_0)$ се съдържа в $U$. Да разгледаме паралелотопа 
$$\Delta := \left\{x\in\R^n \ : \  x_{i}^0 - \frac{\varepsilon}{\sqrt{n}} \leq x_i \leq  x_{i}^0 +\frac{\varepsilon}{\sqrt{n}}, \ i=1,2,\dots , n\right\} \ .$$
Ако $x$ е произволна точка от $\Delta$, можем да оценим разстоянието
$$\left\| x-x_0\right\| =\sqrt{\sum_{i=1}^n\left( x_i-x^0_i\right)^2} \le \sqrt{\sum_{i=1}^n\left(\frac{\varepsilon}{\sqrt{n}}\right)^2} =\sqrt{n \cdot \frac{\varepsilon^2}{n}}=\varepsilon <2\varepsilon\ .$$
 Следователно $\Delta \subset B_{2\varepsilon}(x_0)\subset U$. Паралелотопът $\Delta$ е неизроден и тогава от горния пример следва, че не е пренебрежимо множество. Оттук и от $\Delta \subset U$ следва, че $U$ също не може да е пренебрежимо по Лебег.
\end{proof}

\subsection{Критерий на Лебег за интегруемост по Риман}

\begin{thm}[Критерий на Лебег за интегруемост по Риман]
Нека $\Delta$ е паралелотоп в $\R^n$ и $f:\Delta \longrightarrow \R$. Твърдим, че функцията $f$ е интегруема по Риман точно тогава, когато е ограничена и 
множеството от точките \`{и} на прекъсване  е пренебрежимо по Лебег.
\end{thm}

\medskip
Да отбележим, че тази теорема е нова за вас и в едномерния случай ($n=1$). Спомнете си твърденията, доказани в ДИС1 за "някои класове интегруеми функции". Всички те са директно следствие от критерия на Лебег. Наистина, ако една функция е непрекъсната в $[a,b]$, то тя е ограничена (Вайерщрас) и множеството от точките \`{и} на прекъсване е празно, значи пренебрежимо. Ако една ограничена функция има краен брой точки на прекъсване, то тя е интегруема по критерия на Лебег, защото крайните множества са пренебрежими. Тъй като монотонните функции в $[a,b]$ са ограничени (стойностите им са между $f(a)$ и $f(b)$) и имат най-много изброимо много точки на прекъсване, твърдението за тяхната интегруемост също е следствие от горната теорема.
\medskip

С $R_f$ ще означаваме множеството от точките на прекъсване на функцията $f$.
\medskip

\begin{proof}
Ще използваме и в двете посоки на доказателството втората форма на критерия за интегруемост (Твърдение \ref{second_criterium}).

Нека функцията $f$ е интегруема по Риман. Тогава тя, разбира се, е ограничена, и трябва да докажем пренебрежимостта на множеството $R_f$. Фиксираме произволно $\varepsilon >0$. Избираме сходящ ред с положителни членове и сума $\varepsilon$: $\sum_{m=1}^\infty \alpha_m =\varepsilon$, $\alpha_m >0$ за всяко естествено $m$. Прилагаме втората втората форма на критерия за интегруемост за положителните числа $\alpha_m$ и $1/m$. Получаваме подразбиване $\Pi_m$ на $\Delta$ такова, че
$$\sum_{M_k^m-m_k^m\geq \frac{1}{m}}\mu_n(\Delta_k^m)<\alpha_m \ .$$
Да означим с $\Pi_m'$ множеството от онези елементи на подразбиването $\Pi_m$, в които осцилацията на $f$ е по-голяма или равна на $1/m$ (т.е. знаем, че $\sum_{\Box\in \Pi'_m}\mu_n(\Box)<\alpha_m$). Да означим с $P_m$ множеството от делящите стени на $\Pi_m$ (т.е. $P_m$ е множеството от паралелотопите, от които се състои $\bigcup_{\Box\in \Pi_m}\partial \Box$). Ясно е, че $P_m$ е крайно множество от изродени паралелотопи. Тогава
$$\left(\bigcup_{m=1}^\infty \Pi_m'\right)\cup \left(\bigcup_{m=1}^\infty P_m\right)$$
е изброимо множество от паралелотопи в $\R^n$ със сумарна мярка, по-малка от $\varepsilon$. Наистина
$$\sum_{m=1}^\infty\left(\sum_{\Box\in \Pi_m'}\mu_n(\Box) +\sum_{\Box\in P_m}\mu_n(\Box)\right)< \sum_{m=1}^\infty (\alpha_m +0)=\varepsilon \ .$$
Остава да се убедим, че обединението на паралелотопите от $\left(\bigcup_{m=1}^\infty \Pi_m'\right)\cup \left(\bigcup_{m=1}^\infty P_m\right)$ покрива $R_f$. Да изберем произволна точка 
$$x\in \Delta\setminus \left(\bigcup\left\{\Box \ : \ \Box\in\left(\bigcup_{m=1}^\infty \Pi_m'\right)\cup \left(\bigcup_{m=1}^\infty P_m\right)\right\}\right) \ .$$
Сега за произволно естествено $m$ съществува паралелотоп $\Delta^m_x \in \Pi_m$ такъв, че $x\in \Delta^m_x$. При това $x\in \mathring \Delta^m_x$, защото $x$ не принадлежи на $\bigcup_{\Box\in \Pi_m}\partial \Box$ (това множество се покрива от елементите на $P_m$) и осцилацията на $f$ в $\mathring \Delta^m_x$ е по-малка от $1/m$, защото $\Delta^m_x\not\in \Pi_m'$. Следователно $|f(y)-f(x)|<1/m$ за всяко $y\in \mathring \Delta^m_x$ (заради осцилацията). И тъй, за произволно естествено $m$ намерихме околност $\mathring \Delta^m_x$ на $x$ такава, че $|f(y)-f(x)|<1/m$ за всяко $y\in \mathring \Delta^m_x$. Следователно функцията $f$ е непрекъсната в $x$, т.е. $x\not \in R_f$. С това завършихме доказателството на пренебрежимостта на $R_f$.
\medskip

Сега се обръщаме към доказателството на обратната посока. Предполагаме, че $f$ е ограничена и множеството от точките \`{и} на прекъсване  е пренебрежимо по Лебег. Ще доказваме, че $f$ е интегруема, като използваме втората форма на критерия за интегруемост. За целта избираме произволни $\varepsilon>0$ и $\eta>0$ и ги фиксираме.

Тъй като $R_f$ е пренебрежимо и $\varepsilon>0$, от Твърдение \ref{negligibleinteriors} съществуват изброимо много паралелотопи $\{\Delta_k \}_{k=1}^\infty$ такива, че $$\bigcup_{k=1}^\infty \mathring\Delta_k \supset R_f  \mbox{ и } \sum_{k=1}^\infty \mu_n(\Delta_k)<\varepsilon \ .$$
Да означим
$$C := \Delta\setminus \left(\bigcup_{k=1}^\infty \mathring\Delta_k\right) \ .$$
Множеството $C$ е компакт (ограничено е, защото се съдържа в $\Delta$, а е затворено, защото е сечение на затвореното $\Delta$ и допълнението на $\bigcup_{k=1}^\infty \mathring\Delta_k$, което е отворено като обединение на отворени). При това $C\cap R_f=\emptyset$, следователно $f$ е непрекъсната във всяка точка на $C$. Прилагаме обобщената теорема на Кантор, която доказахме в първата лекция (Теорема \ref{genCantor}), към функцията $f$. Следователно съществува $\delta >0$ такова, че за всяко $x\in C$ и за всяко $y\in \Delta$, за което $\| y-x\|<\delta$, е в сила $|f(x)-f(y)|<\eta/4$. Да изберем произволно подразбиване $\Pi$ на $\Delta$, чийто диаметър е по-малък от $\delta$. Ще докажем, че за това подразбиване е в сила неравенството от втората форма на критерия за интегруемост.

Нека $\Pi=\{ \Box_i\}_{i=1}^{i_0}$. Да проверим, че ако някой от паралелотопите от $\Pi$ има непразно сечение с $C$, то осцилацията на $f$ върху него е по-малка от $\eta$. Наистина, нека $\Box_i \cap C\not =\emptyset$ за някое $i\in \{ 1,2,\dots ,i_0\}$. Фиксираме $x\in \Box_i \cap C$ (такава има) и нека $y\in \Box_i$ е произволна. Тъй като $\textrm{diam} \Box_i \le d(\Pi)<\delta$, получаваме, че $\| x-y\| <\delta$. Сега от избора на $\delta$ от теоремата на Кантор и от $x\in C$ имаме $|f(x)-f(y)|<\eta/4$. Следователно
$$M_i:=\sup \left\{ f(y): \ y\in \Box_i\right\} \le f(x)+\frac{\eta}{4} \ ,$$
$$m_i:=\inf \left\{ f(y): \ y\in \Box_i\right\} \ge f(x)-\frac{\eta}{4} \ .$$
Оттук получаваме, че 
$$M_i-m_i \le \left( f(x)+\frac{\eta}{4}\right)-\left( f(x)-\frac{\eta}{4}\right)=\frac{\eta}{2}<\eta \ .$$
И тъй, ако осцилацията на $f$ върху даден елемент от $\Pi$ е по-голяма или равна на $\eta$, то този елемент се съдържа в $\Delta\setminus C$. Да означим 
$$K:= \bigcup\left\{ \Box_i \in \Pi \ : \ M_i-m_i \ge \eta\right\} \subset \Delta\setminus C = \bigcup_{k=1}^\infty \mathring\Delta_k \ .$$
Тъй като $K$ е компакт като обединение на краен брой затворени паралелотопи, то съществува $k_0\in \N$ такова, че
$$K\subset \bigcup_{k=1}^{k_0} \mathring\Delta_k \subset\bigcup_{k=1}^{k_0} \Delta_k \ .$$
Сега можем да приложим Лема \ref{finitecover}, защото $K$ е крайно обединение на паралелотопи, които не се припокриват, и да получим
$$\sum_{M_i-m_i \ge \eta} \mu_n(\Box_i) \le \sum_{k=1}^{k_0} \mu_n(\Delta_k) \le \sum_{k=1}^\infty \mu_n(\Delta_k) < \varepsilon \ .$$
С това доказателството е завършено.
\end{proof}


\subsection{Основни свойства на интеграла на Риман върху паралелотоп}

Критерият на Лебег за интегруемост по Риман улеснява много доказателствата на твърдения за интегруемост. Следното следствие е добър пример за това:

\begin{cor}
Нека $\Delta$ е паралелотоп в $\R^n$ и нека $f, g: \Delta \longrightarrow \R$ са интегруеми по Риман. Тогава
\\
(а) Сумата $f+g$ и произведението $f\cdot g$ им са интегруеми по Риман;
\\
(б) Ако съществува $\varepsilon_0 >0$ такова, че $|g(x)|\geq \varepsilon_0$ за всички $x \in \Delta$, то частното $\frac{f}{g}$ е функция, интегруема по Риман;
\\
(в) По-общо, ако $\Phi :\R^k \longrightarrow \R$  е непрекъсната и $f_1, \dots , f_k:\Delta \longrightarrow \R$ са интегруеми по Риман, то $\Phi (f_1,\dots ,f_k)$ е интегруема по Риман.
\end{cor}

\begin{proof}
Ще започнем с доказателството на (в), понеже е ясно, че (а) е частен случай на (в). Тъй като композиция на непрекъснати функции е непрекъсната, веднага получаваме, че ако в дадена точка $x\in \Delta$ функциите $f_1, \dots , f_k$ са непрекъснати, то $\Phi (f_1,\dots ,f_k)$ също е непрекъсната в $x$. Следователно
$$\Delta\setminus \left( R_{f_1}\cup R_{f_2}\cup \dots \cup R_{f_k}\right)\subset \Delta\setminus R_{\Phi (f_1,\dots ,f_k)} \mbox{, което влече } R_{\Phi (f_1,\dots ,f_k)}\subset R_{f_1}\cup R_{f_2}\cup \dots \cup R_{f_k} \ .$$
Сега от интегруемостта на $f_1, \dots , f_k$ следва пренебрежимостта на множествата $R_{f_1}$, $R_{f_2}$, $\dots$, $R_{f_k}$ и тогава горното включване показва, че $R_{\Phi (f_1,\dots ,f_k)}$ също е пренебрежимо. За да довършим доказателството на (в), остава да проверим ограничеността на $\Phi (f_1,\dots ,f_k)$. Наистина, тъй като $f_1, \dots , f_k$ са ограничени, то множеството от стойностите
$\{ (f_1(x), \dots , f_k(x))\in \R^k \ : \ x\in \Delta\}$ се съдържа в паралелотоп в $\R^k$, който е компакт. Остава да приложим теоремата на Вайерщрас за $\Phi$.

Остава да проверим (б). Аналогично на горното получаваме, че $R_{\frac{f}{g}}\subset R_{f}\cup R_{g}$ и следователно $R_{\frac{f}{g}}$ е пренебрежимо. Нека $|f(x)|\le M$ за всяко $x\in \Delta$ ($f$ е инрегруема, значи е ограничена). Частното е ограничено, защото
$$\left| \frac{f(x)}{g(x)}\right| \le \frac{M}{\varepsilon_0} \mbox{ за всяко } x\in \Delta \ .$$ 
\end{proof}

Ще завършим тази лекция с основните свойства на римановия интеграл върху паралелотоп $\Delta$ в $\R^n$:
\medskip

\begin{enumerate}
\item \textbf{Линейност.} Нека $f, g: \Delta \longrightarrow\R$ са интегруеми функции и $\lambda\in \R$. Тогава 
$f+g$ и $\lambda f$ са интегруеми функции и 
$$\int_\Delta (f+g) = \int_\Delta f + \int_\Delta g  \ , \ \ \ \int_\Delta (\lambda f)=\lambda\int_\Delta f \ .$$

\begin{proof}
Интегруемостта я имаме наготово от предишното следствие. Остава да забележим, че за произволно подразбиване $\Pi$ на $\Delta$ и за произволни пробни точки $\xi$ за $\Pi$ имаме
$$\sigma_{f+g} (\Pi ,\xi )=\sigma_{f} (\Pi ,\xi )+\sigma_{g} (\Pi ,\xi ) \mbox{ и } \sigma_{\lambda f} (\Pi ,\xi )= \lambda\sigma_{f} (\Pi ,\xi ) \ ,$$
да напишем горните равенства за редица от подразбивания $\{ \Pi_m\}_{m=1}^\infty$ с диаметър, клонящ към нула ($d(\Pi_m)\longrightarrow_{m\to \infty}0$) и да направим граничен преход.
\end{proof}

\item \textbf{Адитивност.} Нека $\Pi = \{ \Delta_i\}_{i=1}^{i_0}$ е подразделяне на $\Delta$ и $f:\Delta\longrightarrow\R$. Твърдим, че $f$ е интегруема точно тогава, когато $f\restriction_{\Delta_1}$, $f\restriction_{\Delta_2}$, $\dots$, $f\restriction_{\Delta_{i_0}}$ са интегруеми. При това
$$\int_\Delta f = \int_{\Delta_1} f + \int_{\Delta_2} f + \dots \int_{\Delta_{i_0}} f \ .$$

\begin{proof}
Очевидно $f$ е ограничена точно тогава, когато $f\restriction_{\Delta_1}$, $f\restriction_{\Delta_2}$, $\dots$, $f\restriction_{\Delta_{i_0}}$ са ограничени. Тъй като $R_{f\restriction_{\Delta_i}}\subset R_f$ за всяко $i=1,2,\dots ,i_0$, от интегруемостта на $f$ следва интегруемостта на $f\restriction_{\Delta_i}$, $i=1,2,\dots ,i_0$. Обратната импликация се получава от включването $R_f \subset R_{f\restriction_{\Delta_1}}\cup R_{f\restriction_{\Delta_2}}\cup \dots \cup R_{f\restriction_{\Delta_{i_0}}}$.

За да получим равенството, вземаме редица от подразбивания $\{ \Pi^m\}_{m=1}^\infty$ с диаметър, клонящ към нула, като $\Pi^m \ge \Pi$ за всяко естедвено $m$. Нека $\xi^m$ са пробни точки за $\Pi^m$. Означаваме
$$\Pi^m_i:=\{ \Box \in \Pi^m: \ \Box\subset \Delta_i\}, \ i=1,2,\dots ,i_0 \ .$$
Нека $\xi^m_i$ са пробните точки от $\xi^m$, които са в паралелотопите от $\Pi^m_i$. Тогава
$$\sigma_f(\Pi^m,\xi^m)=\sigma_f(\Pi^m_1,\xi^m_1)+\sigma_f(\Pi^m_2,\xi^m_2)+\dots +\sigma_f(\Pi^m_{i_0},\xi^m_{i_0}) \ .$$
Тъй като сме сигурни, че всяко събираемо има граница при $m\rightarrow \infty$ и тя е съответният интеграл, правим граничен преход и получаваме търсеното равенство.
\end{proof}

\item \textbf{Монотонност.} Нека $f:\Delta\longrightarrow\R$ е интегруема и $f(x)\ge 0$ за всяко $x\in \Delta$. Тогава $\int_\Delta f \ge 0$. 

    (Директно от факта, че малките суми на Дарбу за $f$ са неотрицателни.)

    \textbf{\textit{Следствие 1.}} Нека $f, g: \Delta \longrightarrow\R$ са интегруеми функции и $f(x)\ge g(x)$ за всяко $x\in \Delta$. Тогава $\int_\Delta f \ge \int_\Delta g$.

    (Наистина, $\int_\Delta f - \int_\Delta g=\int_\Delta (f -g) \ge 0$ от линейността и монотонността.)

\textbf{\textit{Следствие 2.}} Ако $f:\Delta\longrightarrow\R$ е интегруема, то $|f|$ е интегруема и $|\int_\Delta f|\le \int_\Delta |f|$.

(Интегруемостта е директна от критерия на Лебег, а неравенството от $-|f|\le f\le |f|$ и предишното следствие.)
\end{enumerate}

\section{Лекция 4: Мярка на Пеано-Жордан. Интеграл върху измеримо множество}

В тази лекция ще приложим знанията ни за риманов интеграл върху паралелотоп, за да можем по един разумен начин да приписваме мярка на някои подмножества на $\R^n$. Да отбележим, че засега сме говорили за мярка само на паралелотопи.

\subsection{Множества, измерими по Пеано-Жордан}

Нека $A$ е ограничено подмножество на $\R^n$.

\section{Лекция 5: Теорема на Фубини. Интегриране върху криволинеен трапец и цилиндрично тяло. Принцип на Кавалиери. Физически приложения на кратните интеграли. Примери}

\section{Лекция 6: Теорема за смяна на променливите в кратен интеграл 1}

\section{Лекция 7: Теорема за смяна на променливите в кратен интеграл 2}

\section{Лекция 8: Криволинеен интеграл от първи род}

\section{Лекция 9: Криволинеен интеграл от втори род}

\section{Лекция 10: Независимост от пътя на криволинейния интеграл от втори род}

\section{Лекция 11: Лице на повърхнина}

В следващата част от курса ще изучаваме интегрирането върху двумерна повърхнина в тримерното евклидово пространство. Такава повърхнина може да бъде зададена с уравнение, но в този курс ние ще използваме параметричния подход.

\subsection{Елементарна гладка параметрично зададена повърхнина. Допирателно пространство}

Параметрите ще се менят в област $\Omega$, съдържаща се в $\R^2$. Най-често ще ги означаваме с $u=(u_1,u_2)\in \Omega$. Параметризацията $\varphi$ е гладко изображение с дефиниционна област $\Omega$ и област от стойности $\R^3$. Условието за регулярност (съответстващо на условието производната да не се анулира в случая на параметрично зададена крива) е матрицата $\varphi'(u)$ да има пълен ранг във всяка точка на $\Omega$. Скаларно
 записано,
 
$$\varphi(u_1,u_2)=\left( \begin{array}{c}\varphi_1(u_1,u_2)\\\varphi_2(u_1,u_2)\\\varphi_3(u_1,u_2)\end{array}\right) \ , \ \ 
\varphi'(u_1,u_2)=\left( \begin{array}{cc}\frac{\partial\varphi_1}{\partial u_1}(u_1,u_2)&\frac{\partial\varphi_1}{\partial u_2}(u_1,u_2)\\ \frac{\partial\varphi_2}{\partial u_1}(u_1,u_2)&\frac{\partial\varphi_2}{\partial u_2}(u_1,u_2)\\ \frac{\partial\varphi_3}{\partial u_1}(u_1,u_2)&\frac{\partial\varphi_3}{\partial u_2}(u_1,u_2)\end{array}\right)$$
и условията са $\varphi \in C^1(\Omega,\R^3)$ (т.е. частните производни $\frac{\partial\varphi_i}{\partial u_j}$, $i\in \{ 1,2,3\}$, $j\in \{ 1,2\}$ съществуват и са непрекъснати в $\Omega$) и $\textrm{rg} \; \varphi' =2$ в $\Omega$. Тогава множеството $S=\varphi(\Omega)$ наричаме \textit{елементарна гладка параметрично зададена повърхнина}.

\bigskip

Кривите $\varphi(t,u_2)$, $(t,u_2)\in \Omega$, където $u_2$ е фиксирано произволно, лежат върху $S$ и се наричат \textit{координатни линии}. Другото семейство координатни линии е $\varphi(u_1,t)$, $(u_1,t)\in \Omega$, където $u_1$ е фиксирано произволно.


\begin{example} \label{cylinder} Цилиндрична повърхнина.

Нека $\Gamma$ е гладка регулярна параметрично зададена равнинна крива. Означаваме с $\alpha\in C^1(\Delta , \R^2)$, където $\Delta$ е отворен интервал и $\dot\alpha \not = \Z$, една параметризация на
$\Gamma=\alpha(\Delta)$. Тогава $\varphi(t,z) = \begin{pmatrix}
	\alpha_1(t)\\
	\alpha_2(t)\\
	z\\
\end{pmatrix}$, където $t\in\Delta \;, z\in\R$, е параметризация на цилиндричната повърхност $S=\varphi(\Delta\times \R)$. Наистина, рангът на $\alpha'(t,z) = \begin{pmatrix}
	\dot\alpha_1 (t)& 0\\
	\dot\alpha_2 (t)& 0\\
	0 & 1\\
\end{pmatrix}$ е пълен, защото  ако допуснем, че всички минори от втори ред на $\alpha'(t,z)$ са нули, ще получим $\dot\alpha (t) = \Z$, което е противоречие с регулярността на кривата.
\end{example}

\begin{example} \label{surface_of_revolution} Ротационна повърхнина.

Нека $\Gamma$ е гладка регулярна параметрично зададена равнинна крива, лежаща в горната полуравнина. Означаваме с $\alpha\in C^1(\Delta , \R^2)$, където $\Delta$ е отворен интервал, $\dot\alpha \not = \Z$ и $\alpha_2 >0$, една параметризация на
$\Gamma=\alpha(\Delta)$. Тогава
$$\varphi(t,\theta)=\left( \begin{array}{c}\alpha_1(t)\\ \alpha_2(t)\cos \theta\\ \alpha_2(t)\sin \theta\end{array}\right) \ ,  \mbox{ където }t\in \Delta \mbox{ и } \theta\in \R \ ,$$
задава гладка повърхнина в пространството. От проверка се нуждае само условието за ранга. Пресмятаме минорите от втори ред на
$$\varphi'(t,\theta)=\left( \begin{array}{cc}\dot\alpha_1(t)&0 \\ \dot\alpha_2(t)\cos \theta & -\alpha_2(t)\sin \theta\\ \dot\alpha_2(t)\sin \theta&\alpha_2(t)\cos \theta
\end{array}\right) \ .$$
Ако допуснем, че всички те се анулират, имаме
$$-\dot\alpha_1(t)\alpha_2(t)\sin \theta=\dot\alpha_1(t)\alpha_2(t)\cos
 \theta=\alpha_2(t)\dot\alpha_2(t)(\cos^2\theta+\sin^2\theta
 )=0$$
 и следователно, отчитайки $\alpha_2(t) >0$ и факта, че $\cos \theta$ и $\sin \theta$ не могат да се анулират едновременно, получаваме $\dot\alpha_2(t)=\dot\alpha_1(t)=0$, противоречие с регулярността на кривата.
 \end{example}

\begin{example} \label{sphere} Сфера.

В сегашната постановка не можем да напишем параметризация на цялата сфера (това е дълбок и неочевиден факт), затова ще използваме стандартните ъгли, за да напишем параметризация на сферата без двата полюса:
$$\varphi(\theta_1,\theta_2)=\left( \begin{array}{c}R\cos\theta_1 \sin\theta_2 \\ R\sin\theta_1 \sin\theta_2\\ R\cos\theta_2\end{array}\right) \ , \ \theta_1\in \R \ , \theta_2\in (0,\pi) \ .$$
За да проверим условието за ранга, пресмятаме минорите на
$$\varphi'(\theta_1,\theta_2)=\left( \begin{array}{cc} -R\sin\theta_1 \sin\theta_2&R\cos\theta_1 \cos\theta_2 \\ R\cos\theta_1 \sin\theta_2 & R\sin\theta_1 \cos\theta_2\\ 0& -R\sin\theta_2
\end{array}\right)$$ и използваме, че $\sin\theta_2>0$, за да се убедим, че не е възможно всички минори от втори ред на горната матрица да се анулират.
\end{example}

\bigskip

За упражнение разберете как изглеждат двете семейства координатни линии във всеки от горните примери.

\bigskip

Гладкостта на параметризацията и условието за ранга гарантират съществуването на еднозначно определена допирателна равнина към повърхнината във всяка точка. За да се убедим в това, първо ще дадем геометрично определение на понятието ``допирателно пространство'', което се съгласува с геометричната ни интуиция. И тъй, нека $S$ е двумерна повърхнина в $\R^3$ и нека $p\in S$. С $S_p$ ще означаваме множеството от свързаните вектори $(p;w)\in S\times \R^3$, които са допирателни в точката $p$ към някаква гладка крива, лежаща изцяло в $S$:
$$S_p:=\{(p;w)\in S\times \R^3 \ : \ \exists \ \delta>0 \ \exists \ \alpha \in C^1(\Delta , S) \  (\Delta\equiv (-\delta,\delta)) , \ \alpha(0)=p, \ \dot\alpha(0)=w\} \ .$$
Ако не знаем нещо повече за $S$, предварително не е ясно дали $S_p$ е равнина и дори дали не се състои само от нулевия вектор. Ще се убедим, че $\{ w\in \R^3 : \ (p;w)\in S_p\}$ е двумерно линейно подпространство на $\R^3$, ако $S$ е елементарна гладка параметрично зададена повърхнина.

\begin{defn} Нека $\varphi : \Omega \longrightarrow \R^3$, където $\Omega$ е област в $\R^2$, е гладко изображение. Диференциал на $\varphi$ наричаме изображението $\textrm{d}\varphi:\Omega\times \R^2\longrightarrow \R^3\times \R^3$, зададено с формулата
$$\textrm{d}\varphi (u;v):= \left(\varphi(u)\; ; \;\frac{\partial\varphi}{\partial u_1}(u)\cdot v_1+\frac{\partial\varphi}{\partial u_2}(u)\cdot v_2\right)\ , $$ където $$v=(v_1,v_2) \ , \ \frac{\partial\varphi}{\partial u_1}(u)=\left( \begin{array}{c}\frac{\partial\varphi_1}{\partial u_1}(u)\\ \frac{\partial\varphi_2}{\partial u_1}(u)\\ \frac{\partial\varphi_3}{\partial u_1}(u)\end{array}\right) \mbox{ и } \frac{\partial\varphi}{\partial u_2}(u)=\left( \begin{array}{c}\frac{\partial\varphi_1}{\partial u_2}(u)\\ \frac{\partial\varphi_2}{\partial u_2}(u)\\ \frac{\partial\varphi_3}{\partial u_2}(u)\end{array}\right) \ .$$
\end{defn}

 За да разберем смисъла на тази дефиниция, ще покажем, че ако $\varphi$ носи една гладка крива $\Gamma \subset\Omega$ в кривата $\tilde{\Gamma}=\varphi(\Gamma)$, то $\textrm{d}\varphi$ носи допирателните вектори към $\Gamma$ в допирателни вектори към $\tilde{\Gamma}$ в съответната точка.

\begin{lem}\label{diff_lines}
 Нека $\varphi : \Omega \longrightarrow \R^3$, където $\Omega$ е област в $\R^2$, е гладко изображение и нека $\Gamma=\alpha(\Delta)$ е гладка крива ($\Delta$ е интервал и $\alpha\in C^1(\Delta,\Omega)$). Нека $\tilde{\Gamma}=\varphi(\Gamma)=\varphi(\beta(\Delta))$ е нейният образ ($\beta(t):=\varphi(\alpha(t))$, $t\in \Delta$). Тогава $\textrm{d}\varphi(\alpha(t);\dot\alpha(t))=(\beta(t);\dot\beta(t))$, $t\in \Delta$.
\end{lem}
\begin{proof}
Наистина, пресмятайки производната на $\beta(t) = \begin{pmatrix}
	\varphi_1(\alpha_1(t),\alpha_2(t))\\
	\varphi_2(\alpha_1(t),\alpha_2(t))\\
	\varphi_3(\alpha_1(t),\alpha_2(t))\\
\end{pmatrix}$, получаваме $\dot\beta (t) = \begin{pmatrix}
	\frac{\partial \varphi_1(\alpha(t))}{\partial  u_1}\dot\alpha_1(t)+\frac{\partial \varphi_1(\alpha(t))}{\partial  u_2}\dot\alpha_2(t)\\
	\frac{\partial \varphi_2(\alpha(t))}{\partial  u_1}\dot\alpha_1 (t)+\frac{\partial \varphi_2(\alpha(t))}{\partial  u_2}\dot\alpha_2 (t)\\
	\frac{\partial \varphi_3(\alpha(t))}{\partial  u_1}\dot\alpha_1 (t)+\frac{\partial \varphi_3(\alpha(t))}{\partial  u_2}\dot\alpha_2 (t)\\
\end{pmatrix} = \frac{\partial \varphi(\alpha(t))}{\partial  u_1}\dot\alpha_1 (t)+\frac{\partial \varphi(\alpha(t))}{\partial  u_2}\dot\alpha_2 (t)$.
\end{proof}

Да отбележим, че от горното пресмятане се получава, че свързаните вектори \\$\left(\varphi(u);\frac{\partial\varphi}{\partial u_1}(u)\right)$ са допирателни към първото семейство координатни линии, а $\left(\varphi(u);\frac{\partial\varphi}{\partial u_2}(u)\right)$ са допирателни към второто семейство координатни линии.


\begin{lem}\label{explicit}
Нека $\Omega$ е област в равнината, $\varphi\in (\Omega ,\R^3)$ и $\textrm{rg}\; \varphi'=2$ в $\Omega$. Тогава за всяка точка $p=\varphi(u)$ от елементарната гладка параметрично зададена повърхнина $S=\varphi(\Omega)$ съществуват $U\subset\Omega$ околност на $u$ и $V$ околност $p$ такива, че $\varphi\restriction_{U}$ е биекция между $U$ и $S\cap V$. При това обратната биекция $\left(\varphi\restriction_{U}\right)^{-1}$ е рестрикция върху $S\cap V$ на гладко изображение, дефинирано във $V$.
\end{lem}

\begin{proof}
Тъй като $\textrm{rg} \; \varphi '(u)=2$,  без ограничение на общността можем да приемем, че
$$det\left( \begin{array}{cc}\frac{\partial\varphi_1}{\partial u_1}(u)&\frac{\partial\varphi_1}{\partial u_2}(u)\\ \frac{\partial\varphi_2}{\partial u_1}(u)&\frac{\partial\varphi_2}{\partial u_2}(u)\end{array}\right)\not = 0 \ .$$
От Теоремата за обратната функция получаваме, че съществуват $U\subset\Omega$ околност на $u$ и $\tilde{V}$ околност $(\varphi_1(u),\varphi_2(u))$ такива, че
$$\left| \begin{array}{c}x_1=\varphi_1(v_1,v_2)\\ x_2=\varphi_2(v_1,v_2)\end{array}\right. \Leftrightarrow
\left| \begin{array}{c}v_1=\psi_1(x_1,x_2)\\ v_2=\psi_2(x_1,x_2)\end{array}\right.$$
за $(v_1,v_2)\in U$ и $(x_1,x_2)\in\tilde{V}$, където $\psi_1$ и $\psi_2$ са гладки функции, дефинирани във  $\tilde{V}$. Полагаме $V:= \tilde{V}\times \R$ и забелязваме, че
$$\left(\varphi\restriction_{U}\right)^{-1}(x_1,x_2,x_3)=(\psi_1(x_1,x_2),\psi_2(x_1,x_2))\in U$$
за $(x_1,x_2,x_3)\in {V}\cap S$. Освен това
$$S\cap V =\left\{ (x_1,x_2,x_3)\in \R^3 \ : \  (x_1,x_2)\in \tilde{V}, \ x_3=\varphi_3(\psi_1(x_1,x_2),\psi_2(x_1,x_2))\right\}$$
и $V$ е околност на $p$.
\end{proof}

Забележете, че от горното доказателство се вижда, че всяка елементарна гладка параметрично зададена повърхнина локално може да бъде задена явно, т.е. две от променливите могат да бъдат използвани за параметри, а третата да е тяхна функция.

\begin{thm}
Нека $\Omega$ е област в равнината, $\varphi\in (\Omega ,\R^3)$ и $\textrm{rg}\; \varphi'=2$ в $\Omega$. Тогава за всяка точка $p=\varphi(u)$ от елементарната гладка параметрично зададена повърхнина $S=\varphi(\Omega)$ е в сила $S_p\equiv \textrm{d}\varphi (u;\R^2)$, т.е. $\{ w\in \R^3 : \ (p;w)\in S_p\}$ е линейната обвивка на векторите $\frac{\partial\varphi}{\partial u_1}(u)$ и $\frac{\partial\varphi}{\partial u_2}(u)$:
$$S_{p}\equiv \left\{ (p;w)\in S\times \R^3 \ : \ w=\frac{\partial\varphi}{\partial u_1}(u)\cdot v_1+\frac{\partial\varphi}{\partial u_2}(u)\cdot v_2 \mbox{ за някой вектор } (v_1,v_2)\in \R^2\right\} \ .$$
\end{thm}

\begin{proof}
Нека $(p;w)\in S_{p}$. Следователно съществува гладко изображение \\$\beta:(-\delta,\delta)\longrightarrow S$ (тук $\delta$ е някакво положително число) такова, че $(p;w)=(\beta(0),\dot{\beta}(0))$. Нека $U$ и $V$ са околностите на $u$ и $p$ съответно, получени от Лема \ref{explicit}. С цената на намаляване на $\delta$ можем да предположим, че $\beta(t)\in V$ за всяко $t\in (-\delta,\delta)$. Полагаме $\alpha(t):= \left(\varphi\restriction_{U}\right)^{-1} (\beta(t))$ за $t\in (-\delta,\delta)$. Ясно е, че това е параметризация на гладка крива в $U$, за която $\alpha(0)=u$ и $\beta(t)=\varphi(\alpha(t))$. Сега Лема \ref{diff_lines} ни дава $$\textrm{d}\varphi(u;\dot\alpha(0))=\textrm{d}\varphi(\alpha(0);\dot\alpha(0))=(\beta(0);\dot\beta(0))=(p;w) \ .$$
Обратно, нека $(p;w)=\textrm{d}\varphi(u;v)$. За достатъчно малко $\delta$ имаме, че $\alpha(t)=u+t\cdot v\in \Omega$ за всяко $t\in (-\delta,\delta)$. Тогава $\beta(t)=\varphi(\alpha(t))$, $t\in (-\delta,\delta)$ е гладка крива в $S$, като $\beta(0)=\varphi(\alpha(0))=\varphi(u)=p$. Отново от Лема \ref{diff_lines} и от $\dot\alpha(t)=v$ получаваме
$$(p;w)=\textrm{d}\varphi(u;v)=\textrm{d}\varphi(\alpha(0);\dot\alpha(0))=(\beta(0);\dot\beta(0))\in S_p \ .$$
\end{proof}

Важно е да осъзнаем, че линейната обвивка на векторите $\frac{\partial\varphi}{\partial u_1}(u)$ и $\frac{\partial\varphi}{\partial u_2}(u)$ е равнина, защото условието за ранга $\textrm{rg}\; \varphi' (u)=2$ е еквивалентно на линейната независимост на тези два вектора.

\subsection{Формула за лице на гладка повърхнина}

Да напомним, че в курса по ДИС1 строго се дефинира понятието ``дължина на параметрично зададена крива''. В случая на параметрично зададена повърхност нещата са по-сложни, защото подходът с частично плоски повърхнини, вписани в дадената, не дава разумен резултат. Наистина, има пример на Hermann Schwarz (виж Фихтенгольц трети том), който показва, че в цилиндър могат да бъдат вписвани редици от частично плоски повърхнини с диаметър на парченцата, клонящ към нула, и с граница на лицата произволно достатъчно голямо реално число. Затова ще дадем само евристично обяснение на формулата за лице и ще покажем, че резултатите от тази формула се съгласуват с целия ни досегашен опит.

\bigskip

Нека $\Omega$ е област в равнината, $\varphi\in (\Omega ,\R^3)$ е инекция, $\textrm{rg}\; \varphi'=2$ в $\Omega$ и $\Delta$ е правоъгълник, съдържащ се в $\Omega$. Искаме да апроксимираме лицето на $S=\varphi(\Delta)$. Избираме произволно подразделяне $\Pi =\{ \Delta_i\}_{i=1}^{i_0}$ на $\Delta$ и някакви представителни точки $\xi_i\in \Delta_i$, $i=1,\dots ,i_0$ за това подразделяне. Апроксимираме лицето на парченцето $\varphi(\Delta_i)$ от $S$ с лицето на успоредника, опънат върху векторите $a_i\frac{\partial\varphi}{\partial u_1}(\xi_i)$ и $b_i\frac{\partial\varphi}{\partial u_2}(\xi_i)$, където $a_i$ и $b_i$ са съответно дължината на основата и дължината на височината на правоъгълника $\Delta_i$:
$$\mu_2(\varphi(\Delta_i))\sim a_i \cdot b_i \cdot \left\| \frac{\partial\varphi}{\partial u_1}(\xi_i) \times \frac{\partial\varphi}{\partial u_2}(\xi_i)\right\| = \left\| \frac{\partial\varphi}{\partial u_1}(\xi_i) \times \frac{\partial\varphi}{\partial u_2}(\xi_i)\right\| \cdot \mu_2(\Delta_i) \ .$$
Тогава приближението на лицето на цялата повърхнина е римановата сума
$$\mu_2(S) \sim \Sigma_{i=1}^{i_0}\left\| \frac{\partial\varphi}{\partial u_1}(\xi_i) \times \frac{\partial\varphi}{\partial u_2}(\xi_i)\right\| \cdot \mu_2(\Delta_i) =\sigma_g(\Pi ,\xi )$$
за функцията $g$, подразделянето $\Pi$ и представителните точки $\xi =\{ \xi_1, \dots ,\xi_{i_0}\}$, където
$$g(u)=\left\| \frac{\partial\varphi}{\partial u_1}(u) \times \frac{\partial\varphi}{\partial u_2}(u)\right\| = \sqrt{\textrm{det} \left( {\varphi'}^T (u)\cdot\varphi'(u)\right)} \ .$$
Когато диаметърът на подразбиването клони към нула, римановите суми клонят към
$$\int_\Delta \left\| \frac{\partial\varphi}{\partial u_1}(u) \times \frac{\partial\varphi}{\partial u_2}(u)\right\| \textrm{d}u = \int_\Delta \sqrt{\textrm{det} \left( {\varphi'}^T (u)\cdot\varphi'(u)\right)}\textrm{d}u \ .$$

\begin{defn}
Нека $\Omega$ е област в равнината, $\varphi$ е гладка инекция с дефиниционна област $\Omega$ и област от стойности $\R^3$, $\textrm{rg}\; \varphi'=2$ в $\Omega$ и $K$ е измерим компакт, съдържащ се в $\Omega$. Тогава \textit{лице} на $S=\varphi (K)$ наричаме числото
$$\mu_2(S):= \int_K \sqrt{\textrm{det} \left( {\varphi'}^T (u)\cdot\varphi'(u)\right)} \ \textrm{d}u \ .$$
\end{defn}

Елементите на матрицата ${\varphi'}^T (u)\cdot\varphi'(u)$ имат приети имена:
$$E(u)=\left\langle\frac{\partial\varphi}{\partial u_1}(u),\frac{\partial\varphi}{\partial u_1}(u)\right\rangle \ , \  F(u)=\left\langle\frac{\partial\varphi}{\partial u_1}(u),\frac{\partial\varphi}{\partial u_2}(u)\right\rangle  \ , \  G(u)=\left\langle\frac{\partial\varphi}{\partial u_2}(u),\frac{\partial\varphi}{\partial u_2}(u)\right\rangle \ .$$
В тези означения имаме
$$\mu_2(S)= \int_K \sqrt{E(u)G(u)-F^2(u)} \ \textrm{d}u \ .$$
Да отбележим, че горният интеграл съществува, защото $K$ е измеримо по Пеано-Жордан и подинтегралната функция е непрекъсната поради гладкостта на $\varphi$.

\begin{example} Първата проверка, която е редно да извършим, е дали тази формула дава правилен резултат, ако $\varphi$ е идентитетът, т.е. $S$ всъщност съвпада с подмножеството $K$ на равнината. Тогава $\varphi(u_1,u_2) = \begin{pmatrix}
	u_1\\
    u_2\\
	0\\
\end{pmatrix}$, $\frac{\partial\varphi}{\partial u_1}(u_1,u_2) = \begin{pmatrix}
	1\\
	0\\
	0\\
\end{pmatrix}$, $\frac{\partial\varphi}{\partial u_2}(u_1,u_2) = \begin{pmatrix}
	0\\
	1\\
	0\\
\end{pmatrix}$, $E(u_1,u_2)=1$, $F(u_1,u_2)=0$, $G(u_1,u_2)=1$ и следователно
$$\mu_2(S)= \int_K \sqrt{E(u)G(u)-F^2(u)} \ \textrm{d}u = \int_K 1 \ \textrm{d}u = \mu_2(K) \ ,$$
където отдясно стои лицето (по Пеано-Жордан) на множеството $K$, въведено в първата част на курса.
\end{example}

\begin{example} Лице на цилиндрична повърхнина.

Да разгледаме повърхнината от Пример \ref{cylinder} и да намерим лицето на $S=\varphi([a,b]\times [c,d])$ ($t\in [a,b]\subset \Delta$ и $z\in [c,d]$). Имаме $\varphi(t,z) = \begin{pmatrix}
	\alpha_1(t)\\
	\alpha_2(t)\\
	z\\
\end{pmatrix}$, $\frac{\partial\varphi}{\partial t}(t,z) = \begin{pmatrix}
	\dot \alpha_1(t)\\
	\dot \alpha_2(t)\\
	0\\
\end{pmatrix}$, $\frac{\partial\varphi}{\partial z}(t,z) = \begin{pmatrix}
	0\\
	0\\
	1\\
\end{pmatrix}$, $E(t,z)=\dot \alpha_1^2(t)+\dot \alpha_2^2(t)$, $F(t,z)=0$, $G(t,z)=1$ и следователно
$$\mu_2(S)= \int\int_{[a,b]\times [c,d]} \sqrt{\alpha_1^2(t)+\dot \alpha_2^2(t)} \ \textrm{d}t\textrm{d}z = (d-c)\int_a^b \left\| \dot \alpha (t)\right\| \ \textrm{d}t  \ ,$$
тоест лицето на цилиндъра е равно на дължината на кривата, служеща за негова основа, умножена по височината. Следователно и в този пример резултатът от пресмятането по формулата се съгласува с нашия опит.
\end{example}

\begin{example} \label{area_surface_of_revolution} Лице на ротационна повърхнина.

Да разгледаме повърхнината от Пример \ref{surface_of_revolution}. Тогава
$$\varphi(t,\theta)=\left( \begin{array}{c}\alpha_1(t)\\ \alpha_2(t)\cos \theta\\ \alpha_2(t)\sin \theta\end{array}\right) \ ,  \ \frac{\partial\varphi}{\partial t}(t,\theta)=\left( \begin{array}{c}\dot\alpha_1(t)\\ \dot\alpha_2(t)\cos \theta\\ \dot\alpha_2(t)\sin \theta\end{array}\right) \ , \ \frac{\partial\varphi}{\partial \theta}(t,\theta)=\left( \begin{array}{c}0\\ -\alpha_2(t)\sin \theta\\ \alpha_2(t)\cos \theta\end{array}\right)$$
 и следователно $E(t,\theta)=\dot \alpha_1^2(t)+\dot \alpha_2^2(t)$, $F(t,\theta)=0$, $G(t,\theta)=\alpha_2^2(t)$. Да намерим лицето на ротационната повърхнина $S$, получена при завъртане на кривата $\alpha(t)$, $t\in [a,b]$, т.е. $S=\varphi ([a,b]\times [0,2\pi])$:
 $$\mu_2(S)= \int\int_{[a,b]\times [0,2\pi]} \sqrt{\left(\dot \alpha_1^2(t)+\dot \alpha_2^2(t)\right)\alpha_2^2(t)} \ \textrm{d}t\textrm{d}\theta = 2\pi \int_a^b \alpha_2(t)\left\|\dot \alpha (t)\right\|\textrm{d}t \ .$$
 Ако кривата е графика на гладка функция, т.е. $\alpha(x)=(x,f(x))$, $x\in [a,b]$ за някаква гладка функция $f$ с положителни стойности, то получаваме $\mu_2(S)= 2\pi \int_a^b f(x)\sqrt{1+{f'}^2(x)} \ \textrm{d}x$, което е точно формулата, позната ви от курса по ДИС1.
\end{example}

\begin{example} Лице на сфера.

Използвайки стандартната параметризация на сферата (виж Пример \ref{sphere}), получаваме
$$\frac{\partial\varphi}{\partial \theta_1}(\theta_1,\theta_2)=\left( \begin{array}{c}-R\sin\theta_1 \sin\theta_2 \\ R\cos\theta_1 \sin\theta_2\\ 0\end{array}\right) \ , \ \frac{\partial\varphi}{\partial \theta_2}(\theta_1,\theta_2)=\left( \begin{array}{c}R\cos\theta_1 \cos\theta_2 \\ R\sin\theta_1 \cos\theta_2\\ -R\sin\theta_2\end{array}\right)$$
и оттук $E(\theta_1,\theta_2)=R^2 \sin^2 \theta_2$, $F(\theta_1,\theta_2)=0$, $G(\theta_1,\theta_2)=R^2$.
Тъй като сферата $S$ се получава за $\theta_1\in [0,2\pi]$, $\theta_2\in [0,\pi]$, имаме
$$\mu_2(S)= \int\int_{[0,2\pi]\times [0,\pi]} \sqrt{R^2 \sin^2 \theta_2 \cdot R^2} \ \textrm{d}\theta_1\textrm{d}\theta_2 = 2\pi \int_0^\pi R^2\sin \theta_2\textrm{d}\theta_2 = 4\pi R^2\ ,$$
което е резултатът, познат от училище.
\end{example}

\textbf{Забележка:} В последните три примера допуснахме известна неточност, като разрешихме условието за инективност (а в последния пример и условието за ранга) да се нарушават в множество с мярка нула. Интуитивно тези множества не могат да повлияят на резултата от интегрирането. Ако искаме да бъдем строги, трябва например в Пример \ref{area_surface_of_revolution} да вземем $\theta\in [0,2\pi -\varepsilon]$, да интегрираме и да намерим границата на резултата при $\varepsilon$ клонящо към нула с положителни стойности. Разбира се, ще се окаже същият.

\bigskip

\textbf{Забележка:} В горните примери получихме $F=0$. Геометрически това означава, че върху тези повърхнини двете семейства координатни линии се пресичат под прав ъгъл. 

\subsection{Формулата за лице на гладка повърхнина като частен случай на по-обща формула}

Това, което научихме за лице на параметрично зададена гладка повърхнина, може да бъде разглеждано от малко по-обща гледна точка: Нека $n$ и $k$ са естествени числа с $n\ge k$. Нека $\Omega$ е област в $\R^k$, $\varphi$ е гладка инекция с дефиниционна област $\Omega$ и област от стойности $\R^n$, $\textrm{rg}\; \varphi'\equiv k$ и $K$ е измерим компакт, съдържащ се в $\Omega$. Можем да мислим за $S=\varphi (K)$ като за ``гладка $k$-мерна повърхнина, вложена в $\R^n$''. Тогава \textit{$k$-мерна мярка} на $S$ наричаме числото
$$\mu_k(S):= \int_K \sqrt{\textrm{det} \left( {\varphi'}^T (u)\cdot\varphi'(u)\right)} \ \textrm{d}u \ .$$

\bigskip

Ясно е, че формулата за лице, която разглеждахме досега, е горната за случая $k=2$, $n=3$. Това обяснява защо предпочетохме този запис пред записа с норма на векторното произведение. Добре е да си спомните лекцията за детерминанта на Грам от курса по Линейна алгебра и да направите връзката с нашите разглеждания. 

\bigskip

Да разгледаме ``екстремните случаи'': $k=1$ и $k=n$. 

Ако $k=1$, става въпрос за гладка крива $\varphi(t) = \begin{pmatrix}
	\varphi_1(t)\\
	\dots\\
	\varphi_n(t)\\
\end{pmatrix}$ в $\R^n$ и нейната дължина. Нека $t\in K=[a,b]$. Имаме  $\varphi'(t) = \begin{pmatrix}
	\varphi_1'(t)\\
	\dots\\
	\varphi_n'(t)\\
\end{pmatrix}$, следователно 
$$\mu_1(S) = \int_K \sqrt{\langle\varphi'(t),\varphi'(t)\rangle}dt \; = \; \int_a^b \norm{\varphi'(t)}dt \ ,$$
значи формулата от този параграф съдържа в себе си формулата за дължина на гладка крива.

Ако $k=n$, ``повърхнината'' $S$ е подмножество на евклидовото пространство $\R^n$ и се интересуваме от нейната $n$-мерна мярка $\mu_n (S)=\int_S 1 \textrm{d}x$ (според първата част от този курс). От друга страна, формулата от този параграф дава
$$\mu_n(S)= \int_K \sqrt{\textrm{det} \left( {\varphi'}^T (u)\cdot\varphi'(u)\right)}  \textrm{d}u = \int_K \sqrt{\textrm{det} \left({\varphi'}^T (u)\right)\cdot \textrm{det}\left(\varphi'(u)\right)}  \textrm{d}u =
 \int_K \left|\textrm{det}\left(\varphi'(u)\right)\right|  \textrm{d}u .$$
 От предположението за инективност на $\varphi$ получаваме, че $\varphi$ е биекция между $K$ и $S$. При това $\varphi$ е гладко изображение, дефинирано в околност на $K$, а обратната биекция е рестрикция на гладко изображение, дефинирано в околност на $S$ (от Лема \ref{explicit} -- разбира се, в размерност $n$ -- и от факта, че гладкостта е локално свойство). Следователно можем да приложим Теоремата за смяна на променливите в $n$-кратен интеграл, за да получим
 $$\mu_n (S)=\int_S 1 \textrm{d}x =\int_{\varphi(K)} 1 \textrm{d}x =\int_K \left|\textrm{det}\left(\varphi'(u)\right)\right|  \textrm{d}u \ .$$
 Следователно и в този случай резултатът от формулата от този параграф се съгласува с досегашните ни знания.



\section{Лекция 12: Повърхнинен интеграл от първи род}

\section{Лекция 13: Повърхнинен интеграл от втори род. Повърхнини с край. Индуцирана ориентация на края}

\section{Лекция 14: Формула на Стокс}

\section{Лекция 15: Формула на Гаус-Остроградски}

\end{document}